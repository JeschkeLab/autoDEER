<!doctype html>
<html class="no-js" lang="en" data-content_root="../../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><link rel="index" title="Index" href="../../../genindex.html" /><link rel="search" title="Search" href="../../../search.html" />

    <!-- Generated with Sphinx 8.0.2 and Furo 2024.08.06 -->
        <title>autodeer.gui.main - </title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css?v=fd3f3429" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-toolbox-code.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo-extensions.css?v=302659d7" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../index.html"><div class="brand"> </div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon no-toc" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../../../_static/autoDEER_EPR_light.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../../../_static/autoDEER_EPR_dark.svg" alt="Dark Logo"/>
  </div>
  
  <span class="sidebar-brand-text"> </span>
  
</a><form class="sidebar-search-container" method="get" action="../../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../source/Install.html">Installation</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Installation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../source/Install_python.html">Installing Python</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../source/tutorial.html">Tutorial</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Tutorial</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../source/Algorithum.html">The Automated Algorithum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../source/gui_guide.html">autoDEER GUI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../source/Jupyter_interface.html">Jupyter Interface</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../source/API_docs.html">API doc</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../source/autoEPR/index.html">autoEPR</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of autoEPR</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../source/autoEPR/Getting_Started.html">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../source/autoEPR/Sequencer.html">Creating a Custom Sequence</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../source/autoEPR/Interface.html">Interfaces</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Interfaces</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../source/autoEPR/Bruker_interface.html">Bruker Interface</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">About</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../source/releasenotes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../source/contributing.html">Contributing Guide</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/JeschkeLab/autoDEER">Github</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon no-toc" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <h1>Source code for autodeer.gui.main</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">PyQt6.QtWidgets</span> <span class="kn">import</span> <span class="n">QApplication</span><span class="p">,</span> <span class="n">QMainWindow</span><span class="p">,</span> <span class="n">QFileDialog</span><span class="p">,</span><span class="n">QMessageBox</span><span class="p">,</span> <span class="n">QDialog</span><span class="p">,</span> <span class="n">QPushButton</span>
<span class="kn">from</span> <span class="nn">PyQt6</span> <span class="kn">import</span> <span class="n">uic</span>
<span class="kn">import</span> <span class="nn">PyQt6.QtCore</span> <span class="k">as</span> <span class="nn">QtCore</span>
<span class="kn">import</span> <span class="nn">PyQt6.QtGui</span> <span class="k">as</span> <span class="nn">QtGui</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">import</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">traceback</span><span class="o">,</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">threadpoolctl</span> <span class="kn">import</span> <span class="n">threadpool_limits</span>


<span class="kn">from</span> <span class="nn">matplotlib.backends.backend_qtagg</span> <span class="kn">import</span> <span class="n">FigureCanvas</span><span class="p">,</span> <span class="n">NavigationToolbar2QT</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">autodeer</span> <span class="k">as</span> <span class="nn">ad</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">autodeer.gui.tools</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">autodeer.gui.autoDEER_worker</span> <span class="kn">import</span> <span class="n">autoDEERWorker</span>
<span class="kn">from</span> <span class="nn">autodeer.gui.quickdeer</span> <span class="kn">import</span> <span class="n">DEERplot</span>
<span class="kn">from</span> <span class="nn">autodeer.gui.log</span> <span class="kn">import</span> <span class="n">LogDialog</span>
<span class="kn">from</span> <span class="nn">autodeer.gui.modetune</span> <span class="kn">import</span> <span class="n">ModeTune</span>
<span class="kn">import</span> <span class="nn">yaml</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">from</span> <span class="nn">autodeer.Logging</span> <span class="kn">import</span> <span class="n">setup_logs</span><span class="p">,</span> <span class="n">change_log_level</span>

<span class="c1"># main_log = logging.getLogger(&#39;autoDEER&#39;)</span>
<span class="kn">from</span> <span class="nn">queue</span> <span class="kn">import</span> <span class="n">Queue</span>

<div class="viewcode-block" id="package_directory">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.package_directory">[docs]</a>
<span class="n">package_directory</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">))</span></div>


<span class="n">QtCore</span><span class="o">.</span><span class="n">QDir</span><span class="o">.</span><span class="n">addSearchPath</span><span class="p">(</span><span class="s1">&#39;icons&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">package_directory</span><span class="si">}</span><span class="s2">/resources&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="SampleConcComboBox_opts">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.SampleConcComboBox_opts">[docs]</a>
<span class="n">SampleConcComboBox_opts</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Normal&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;High (0.5x)&#39;</span><span class="p">:</span><span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;Low (2x)&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;Very Low (5x)&#39;</span><span class="p">:</span><span class="mi">5</span><span class="p">}</span></div>


<div class="viewcode-block" id="WorkerSignals">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.WorkerSignals">[docs]</a>
<span class="k">class</span> <span class="nc">WorkerSignals</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QObject</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Defines the signals available from a running worker thread.</span>

<span class="sd">    Supported signals are:</span>

<span class="sd">    finished</span>
<span class="sd">        No data</span>

<span class="sd">    error</span>
<span class="sd">        tuple (exctype, value, traceback.format_exc() )</span>

<span class="sd">    result</span>
<span class="sd">        object data returned from processing, anything</span>

<span class="sd">    progress</span>
<span class="sd">        int indicating % progress</span>

<span class="sd">    &#39;&#39;&#39;</span>
<div class="viewcode-block" id="WorkerSignals.finished">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.WorkerSignals.finished">[docs]</a>
    <span class="n">finished</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">pyqtSignal</span><span class="p">()</span></div>

<div class="viewcode-block" id="WorkerSignals.error">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.WorkerSignals.error">[docs]</a>
    <span class="n">error</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">pyqtSignal</span><span class="p">(</span><span class="nb">tuple</span><span class="p">)</span></div>

<div class="viewcode-block" id="WorkerSignals.result">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.WorkerSignals.result">[docs]</a>
    <span class="n">result</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">pyqtSignal</span><span class="p">(</span><span class="nb">object</span><span class="p">)</span></div>

<div class="viewcode-block" id="WorkerSignals.progress">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.WorkerSignals.progress">[docs]</a>
    <span class="n">progress</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">pyqtSignal</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span></div>
</div>


<div class="viewcode-block" id="Worker">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.Worker">[docs]</a>
<span class="k">class</span> <span class="nc">Worker</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRunnable</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Worker thread</span>

<span class="sd">    Inherits from QRunnable to handler worker thread setup, signals and wrap-up.</span>

<span class="sd">    :param callback: The function callback to run on this worker thread. Supplied args and</span>
<span class="sd">                     kwargs will be passed through to the runner.</span>
<span class="sd">    :type callback: function</span>
<span class="sd">    :param args: Arguments to pass to the callback function</span>
<span class="sd">    :param kwargs: Keywords to pass to the callback function</span>

<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Worker</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="c1"># Store constructor arguments (re-used for processing)</span>
<div class="viewcode-block" id="Worker.fn">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.Worker.fn">[docs]</a>
        <span class="bp">self</span><span class="o">.</span><span class="n">fn</span> <span class="o">=</span> <span class="n">fn</span></div>

<div class="viewcode-block" id="Worker.args">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.Worker.args">[docs]</a>
        <span class="bp">self</span><span class="o">.</span><span class="n">args</span> <span class="o">=</span> <span class="n">args</span></div>

<div class="viewcode-block" id="Worker.kwargs">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.Worker.kwargs">[docs]</a>
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span> <span class="o">=</span> <span class="n">kwargs</span></div>

<div class="viewcode-block" id="Worker.signals">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.Worker.signals">[docs]</a>
        <span class="bp">self</span><span class="o">.</span><span class="n">signals</span> <span class="o">=</span> <span class="n">WorkerSignals</span><span class="p">()</span></div>


        <span class="c1"># # Add the callback to our kwargs</span>
        <span class="c1"># self.kwargs[&#39;progress_callback&#39;] = self.signals.progress</span>

    <span class="nd">@QtCore</span><span class="o">.</span><span class="n">pyqtSlot</span><span class="p">()</span>
<div class="viewcode-block" id="Worker.run">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.Worker.run">[docs]</a>
    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Initialise the runner function with passed args, kwargs.</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="c1"># Retrieve args/kwargs here; and fire processing using them</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fn</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">traceback</span><span class="o">.</span><span class="n">print_exc</span><span class="p">()</span>
            <span class="n">exctype</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()[:</span><span class="mi">2</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">error</span><span class="o">.</span><span class="n">emit</span><span class="p">((</span><span class="n">exctype</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">()))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>  <span class="c1"># Return the result of the processing</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">finished</span><span class="o">.</span><span class="n">emit</span><span class="p">()</span>  <span class="c1"># Done</span></div>
</div>


<div class="viewcode-block" id="fieldsweep_fit">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.fieldsweep_fit">[docs]</a>
<span class="k">def</span> <span class="nf">fieldsweep_fit</span><span class="p">(</span><span class="n">fsweep_analysis</span><span class="p">,</span><span class="n">fit</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">fit</span><span class="p">:</span>
        <span class="n">fsweep_analysis</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">xtol</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">,</span> <span class="n">lin_maxiter</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">fsweep_analysis</span><span class="o">.</span><span class="n">smooth</span><span class="p">()</span> <span class="c1"># Always smooth anyway</span>
    <span class="k">return</span> <span class="n">fsweep_analysis</span></div>


<div class="viewcode-block" id="respro_process">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.respro_process">[docs]</a>
<span class="k">def</span> <span class="nf">respro_process</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span><span class="n">f_lims</span><span class="p">,</span> <span class="n">fieldsweep</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">cores</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">respro</span> <span class="o">=</span> <span class="n">ad</span><span class="o">.</span><span class="n">ResonatorProfileAnalysis</span><span class="p">(</span>
        <span class="n">dataset</span><span class="p">,</span><span class="n">f_lims</span><span class="o">=</span><span class="n">f_lims</span>
    <span class="p">)</span>
    <span class="n">fc_guess</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">LO</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">dataset</span><span class="o">.</span><span class="n">LO</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">//</span><span class="mi">2</span><span class="p">]</span>
    <span class="k">with</span> <span class="n">threadpool_limits</span><span class="p">(</span><span class="n">limits</span><span class="o">=</span><span class="n">cores</span><span class="p">,</span> <span class="n">user_api</span><span class="o">=</span><span class="s1">&#39;blas&#39;</span><span class="p">):</span>
        <span class="n">respro</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">cores</span><span class="o">=</span><span class="n">cores</span><span class="p">,</span><span class="n">fc_guess</span><span class="o">=</span><span class="n">fc_guess</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">fieldsweep</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">LO_new</span> <span class="o">=</span> <span class="n">fieldsweep</span><span class="o">.</span><span class="n">LO</span> <span class="o">+</span> <span class="n">ad</span><span class="o">.</span><span class="n">optimise_spectra_position</span><span class="p">(</span><span class="n">respro</span><span class="p">,</span> <span class="n">fieldsweep</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">respro</span><span class="p">,</span> <span class="n">LO_new</span>


    <span class="k">return</span> <span class="n">respro</span></div>


<div class="viewcode-block" id="relax_process">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.relax_process">[docs]</a>
<span class="k">def</span> <span class="nf">relax_process</span><span class="p">(</span><span class="n">dataset</span><span class="p">):</span>

    <span class="c1"># if dataset.axes[0].max()&gt;500:</span>
    <span class="c1">#     dataset.axes = [dataset.axes[0]/1e3]</span>
    <span class="c1"># else:</span>
    <span class="c1">#     dataset.axes = [dataset.axes[0]]</span>
    <span class="k">if</span> <span class="n">dataset</span><span class="p">[</span><span class="s1">&#39;tau1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mf">1e4</span><span class="p">:</span>
        <span class="n">dataset</span><span class="p">[</span><span class="s1">&#39;tau1&#39;</span><span class="p">]</span> <span class="o">/=</span> <span class="mf">1e3</span>
    <span class="n">CP_data</span> <span class="o">=</span> <span class="n">ad</span><span class="o">.</span><span class="n">CarrPurcellAnalysis</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
    <span class="n">CP_data</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="s1">&#39;double&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">CP_data</span></div>


<div class="viewcode-block" id="T2_process">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.T2_process">[docs]</a>
<span class="k">def</span> <span class="nf">T2_process</span><span class="p">(</span><span class="n">dataset</span><span class="p">):</span>
    <span class="n">CP_data</span> <span class="o">=</span> <span class="n">ad</span><span class="o">.</span><span class="n">CarrPurcellAnalysis</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
    <span class="n">CP_data</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="s1">&#39;double&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">CP_data</span></div>


<div class="viewcode-block" id="autoDEERUI">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.autoDEERUI">[docs]</a>
<span class="k">class</span> <span class="nc">autoDEERUI</span><span class="p">(</span><span class="n">QMainWindow</span><span class="p">):</span>


    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
 
        <span class="c1"># loading the ui file with uic module</span>
        <span class="n">uic</span><span class="o">.</span><span class="n">loadUi</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">package_directory</span><span class="si">}</span><span class="s2">/gui2.ui&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
<div class="viewcode-block" id="autoDEERUI.logo_pixmap">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.autoDEERUI.logo_pixmap">[docs]</a>
        <span class="n">logo_pixmap</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QPixmap</span><span class="p">(</span><span class="s1">&#39;icons:logo.png&#39;</span><span class="p">)</span></div>

        <span class="n">logo_pixmap</span> <span class="o">=</span> <span class="n">logo_pixmap</span><span class="o">.</span><span class="n">scaledToHeight</span><span class="p">(</span><span class="mi">60</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logo</span><span class="o">.</span><span class="n">setPixmap</span><span class="p">(</span><span class="n">logo_pixmap</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_spectrometer_connected_light</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;autoDEER&quot;</span><span class="p">)</span>


        <span class="bp">self</span><span class="o">.</span><span class="n">qDEER_tab</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">DEERplot</span><span class="p">())</span>
<div class="viewcode-block" id="autoDEERUI.q_DEER">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.autoDEERUI.q_DEER">[docs]</a>
        <span class="bp">self</span><span class="o">.</span><span class="n">q_DEER</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">qDEER_tab</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">itemAt</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">widget</span><span class="p">()</span></div>

        <span class="bp">self</span><span class="o">.</span><span class="n">lDEER_tab</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">DEERplot</span><span class="p">())</span>
<div class="viewcode-block" id="autoDEERUI.longDEER">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.autoDEERUI.longDEER">[docs]</a>
        <span class="bp">self</span><span class="o">.</span><span class="n">longDEER</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lDEER_tab</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">itemAt</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">widget</span><span class="p">()</span></div>



        <span class="bp">self</span><span class="o">.</span><span class="n">fsweep_toolbar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">respro_toolbar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relax_toolbar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">create_respro_figure</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">create_relax_figure</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">create_fieldsweep_figure</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">advanced_mode_inputs</span><span class="p">()</span>

<div class="viewcode-block" id="autoDEERUI.threadpool">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.autoDEERUI.threadpool">[docs]</a>
        <span class="bp">self</span><span class="o">.</span><span class="n">threadpool</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QThreadPool</span><span class="p">()</span></div>

<div class="viewcode-block" id="autoDEERUI.current_results">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.autoDEERUI.current_results">[docs]</a>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_results</span> <span class="o">=</span> <span class="p">{}</span></div>

<div class="viewcode-block" id="autoDEERUI.current_data">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.autoDEERUI.current_data">[docs]</a>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_data</span> <span class="o">=</span> <span class="p">{}</span></div>

<div class="viewcode-block" id="autoDEERUI.pulses">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.autoDEERUI.pulses">[docs]</a>
        <span class="bp">self</span><span class="o">.</span><span class="n">pulses</span> <span class="o">=</span> <span class="p">{}</span></div>

<div class="viewcode-block" id="autoDEERUI.spectromterInterface">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.autoDEERUI.spectromterInterface">[docs]</a>
        <span class="bp">self</span><span class="o">.</span><span class="n">spectromterInterface</span> <span class="o">=</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="autoDEERUI.waitCondition">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.autoDEERUI.waitCondition">[docs]</a>
        <span class="bp">self</span><span class="o">.</span><span class="n">waitCondition</span> <span class="o">=</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="autoDEERUI.queue">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.autoDEERUI.queue">[docs]</a>
        <span class="bp">self</span><span class="o">.</span><span class="n">queue</span> <span class="o">=</span> <span class="n">Queue</span><span class="p">()</span></div>


        <span class="bp">self</span><span class="o">.</span><span class="n">FullyAutoButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RunFullyAutoDEER</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">AdvancedAutoButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RunAdvancedAutoDEER</span><span class="p">)</span>

<div class="viewcode-block" id="autoDEERUI.docs_url">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.autoDEERUI.docs_url">[docs]</a>
        <span class="n">docs_url</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QUrl</span><span class="p">(</span><span class="s1">&#39;https://jeschkelab.github.io/autoDEER/&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="autoDEERUI.github_url">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.autoDEERUI.github_url">[docs]</a>
        <span class="n">github_url</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QUrl</span><span class="p">(</span><span class="s1">&#39;https://github.com/JeschkeLab/autoDEER/&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="autoDEERUI.issues_url">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.autoDEERUI.issues_url">[docs]</a>
        <span class="n">issues_url</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QUrl</span><span class="p">(</span><span class="s1">&#39;https://github.com/JeschkeLab/autoDEER/issues&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="autoDEERUI.discussion_url">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.autoDEERUI.discussion_url">[docs]</a>
        <span class="n">discussion_url</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QUrl</span><span class="p">(</span><span class="s1">&#39;https://github.com/JeschkeLab/autoDEER/discussions&#39;</span><span class="p">)</span></div>


        <span class="bp">self</span><span class="o">.</span><span class="n">actionDocumentation</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QDesktopServices</span><span class="o">.</span><span class="n">openUrl</span><span class="p">(</span><span class="n">docs_url</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actionGitHub</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QDesktopServices</span><span class="o">.</span><span class="n">openUrl</span><span class="p">(</span><span class="n">github_url</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actionIssues</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QDesktopServices</span><span class="o">.</span><span class="n">openUrl</span><span class="p">(</span><span class="n">issues_url</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actionDiscussions</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QDesktopServices</span><span class="o">.</span><span class="n">openUrl</span><span class="p">(</span><span class="n">discussion_url</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actionOpen_Folder</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">load_folder</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">actionLoadConfig</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_spectrometer_config</span><span class="p">(</span><span class="kc">None</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actionConnect</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">connect_spectrometer</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actionSaveReport</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">create_report</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">show_respro</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_respro</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">OptimisePulsesButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">optimise_pulses_button</span><span class="p">())</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">SampleConcComboBox</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">SampleConcComboBox_opts</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
        

        <span class="bp">self</span><span class="o">.</span><span class="n">Tab_widget</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="c1"># set current folder to home directory</span>
<div class="viewcode-block" id="autoDEERUI.current_folder">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.autoDEERUI.current_folder">[docs]</a>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_folder</span> <span class="o">=</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="autoDEERUI.config">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.autoDEERUI.config">[docs]</a>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="autoDEERUI.connected">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.autoDEERUI.connected">[docs]</a>
        <span class="bp">self</span><span class="o">.</span><span class="n">connected</span> <span class="o">=</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="autoDEERUI.DL_params">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.autoDEERUI.DL_params">[docs]</a>
        <span class="bp">self</span><span class="o">.</span><span class="n">DL_params</span> <span class="o">=</span> <span class="p">{}</span></div>

<div class="viewcode-block" id="autoDEERUI.worker">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.autoDEERUI.worker">[docs]</a>
        <span class="bp">self</span><span class="o">.</span><span class="n">worker</span> <span class="o">=</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="autoDEERUI.starttime">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.autoDEERUI.starttime">[docs]</a>
        <span class="bp">self</span><span class="o">.</span><span class="n">starttime</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span></div>

<div class="viewcode-block" id="autoDEERUI.Bruker">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.autoDEERUI.Bruker">[docs]</a>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bruker</span><span class="o">=</span><span class="kc">False</span></div>

<div class="viewcode-block" id="autoDEERUI.userinput">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.autoDEERUI.userinput">[docs]</a>
        <span class="bp">self</span><span class="o">.</span><span class="n">userinput</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;label_eff&#39;</span><span class="p">:</span><span class="mi">100</span><span class="p">,</span><span class="s1">&#39;MaxTime&#39;</span><span class="p">:</span><span class="mi">24</span><span class="p">}</span></div>


<div class="viewcode-block" id="autoDEERUI.LO">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.autoDEERUI.LO">[docs]</a>
        <span class="bp">self</span><span class="o">.</span><span class="n">LO</span> <span class="o">=</span> <span class="mi">0</span></div>

<div class="viewcode-block" id="autoDEERUI.gyro">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.autoDEERUI.gyro">[docs]</a>
        <span class="bp">self</span><span class="o">.</span><span class="n">gyro</span> <span class="o">=</span> <span class="mf">0.002803632236095</span></div>

<div class="viewcode-block" id="autoDEERUI.cores">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.autoDEERUI.cores">[docs]</a>
        <span class="bp">self</span><span class="o">.</span><span class="n">cores</span> <span class="o">=</span> <span class="mi">1</span></div>

<div class="viewcode-block" id="autoDEERUI.Min_tp">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.autoDEERUI.Min_tp">[docs]</a>
        <span class="bp">self</span><span class="o">.</span><span class="n">Min_tp</span><span class="o">=</span><span class="mi">12</span></div>


<div class="viewcode-block" id="autoDEERUI.deer_settings">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.autoDEERUI.deer_settings">[docs]</a>
        <span class="bp">self</span><span class="o">.</span><span class="n">deer_settings</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ESEEM&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;ExpType&#39;</span><span class="p">:</span><span class="s1">&#39;5pDEER&#39;</span><span class="p">}</span></div>

<div class="viewcode-block" id="autoDEERUI.priorties">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.autoDEERUI.priorties">[docs]</a>
        <span class="bp">self</span><span class="o">.</span><span class="n">priorties</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Auto&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span> <span class="s1">&#39;MNR&#39;</span><span class="p">:</span><span class="mi">200</span><span class="p">,</span> <span class="s1">&#39;Distance&#39;</span><span class="p">:</span> <span class="mi">40</span><span class="p">}</span></div>


        <span class="bp">self</span><span class="o">.</span><span class="n">priotityComboBox</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">priorties</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
<div class="viewcode-block" id="autoDEERUI.correction_factor">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.autoDEERUI.correction_factor">[docs]</a>
        <span class="bp">self</span><span class="o">.</span><span class="n">correction_factor</span><span class="o">=</span><span class="mi">1</span></div>


<div class="viewcode-block" id="autoDEERUI.set_spectrometer_connected_light">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.autoDEERUI.set_spectrometer_connected_light">[docs]</a>
    <span class="k">def</span> <span class="nf">set_spectrometer_connected_light</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">state</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">light_pixmap</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QPixmap</span><span class="p">(</span><span class="s1">&#39;icons:Red.png&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">state</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">light_pixmap</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QPixmap</span><span class="p">(</span><span class="s1">&#39;icons:Green.png&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">state</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">light_pixmap</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QPixmap</span><span class="p">(</span><span class="s1">&#39;icons:Yellow.png&#39;</span><span class="p">)</span>
        
        <span class="n">light_pixmap</span> <span class="o">=</span> <span class="n">light_pixmap</span><span class="o">.</span><span class="n">scaledToHeight</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Connected_Light</span><span class="o">.</span><span class="n">setPixmap</span><span class="p">(</span><span class="n">light_pixmap</span><span class="p">)</span></div>


<div class="viewcode-block" id="autoDEERUI.load_folder">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.autoDEERUI.load_folder">[docs]</a>
    <span class="k">def</span> <span class="nf">load_folder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">folder_path</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">folder_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">folder_path</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">QFileDialog</span><span class="o">.</span><span class="n">getExistingDirectory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Select Directory&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">Path</span><span class="o">.</span><span class="n">home</span><span class="p">())))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pathLineEdit</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">folder_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_folder</span> <span class="o">=</span> <span class="n">folder_path</span>

        <span class="n">setup_logs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_folder</span><span class="p">)</span>
        <span class="k">global</span> <span class="n">main_log</span>
        <span class="n">main_log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s1">&#39;autoDEER&#39;</span><span class="p">)</span>
        <span class="n">main_log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Loading folder </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">current_folder</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>

    
<div class="viewcode-block" id="autoDEERUI.load_epr_file">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.autoDEERUI.load_epr_file">[docs]</a>
    <span class="k">def</span> <span class="nf">load_epr_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">store_location</span><span class="p">):</span>

        <span class="n">filename</span><span class="p">,</span> <span class="n">_</span><span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">getOpenFileName</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span><span class="s2">&quot;Select a File&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_folder</span><span class="p">,</span><span class="s2">&quot;Data (*.DTA *.mat *.h5)&quot;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">filename</span><span class="p">:</span>
                <span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
                <span class="n">filename_edit</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

        <span class="n">dataset</span> <span class="o">=</span> <span class="n">ad</span><span class="o">.</span><span class="n">eprload</span><span class="p">(</span><span class="n">filename_edit</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_data</span><span class="p">[</span><span class="n">store_location</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataset</span></div>


<div class="viewcode-block" id="autoDEERUI.load_spectrometer_config">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.autoDEERUI.load_spectrometer_config">[docs]</a>
    <span class="k">def</span> <span class="nf">load_spectrometer_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_folder</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">about</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;ERORR!&#39;</span><span class="p">,</span> 
                              <span class="s1">&#39;Please open a folder first.&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">filename</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">filename</span><span class="p">,</span> <span class="n">_</span><span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">getOpenFileName</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span><span class="s2">&quot;Select a spectrometer configuration file&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">Path</span><span class="o">.</span><span class="n">home</span><span class="p">()),</span><span class="s2">&quot;Data (*.yaml)&quot;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">filename</span><span class="p">:</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
            <span class="n">filename_edit</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">spectromterInterface</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spectromterInterface</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;modeTuneButton&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">modeTuneDialog</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Resonator_layout</span><span class="o">.</span><span class="n">removeWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">modeTuneButton</span><span class="p">)</span>

        

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename_edit</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">config</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">safe_load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">config</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">logDialog</span> <span class="o">=</span> <span class="n">LogDialog</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logDialog</span><span class="o">.</span><span class="n">hide</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logbutton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">logDialog</span><span class="o">.</span><span class="n">show</span><span class="p">)</span>

        <span class="n">main_log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Loading config file </span><span class="si">{</span><span class="n">filename_edit</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">loglevels</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s1">&#39;autoDEER&#39;</span><span class="p">][</span><span class="s1">&#39;logging&#39;</span><span class="p">]</span>
            <span class="n">change_log_level</span><span class="p">(</span><span class="n">loglevels</span><span class="p">[</span><span class="s1">&#39;autoDEER&#39;</span><span class="p">],</span><span class="n">loglevels</span><span class="p">[</span><span class="s1">&#39;interface&#39;</span><span class="p">])</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">pass</span>
        

        <span class="n">spectrometer</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s1">&#39;Spectrometer&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">spectrometer</span><span class="p">[</span><span class="s1">&#39;Manufacturer&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Bruker&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">spectrometer</span><span class="p">[</span><span class="s1">&#39;AWG&#39;</span><span class="p">]:</span>
                <span class="n">model</span> <span class="o">=</span> <span class="s1">&#39;Bruker_AWG&#39;</span>
            <span class="k">elif</span> <span class="n">spectrometer</span><span class="p">[</span><span class="s1">&#39;MPFU&#39;</span><span class="p">]:</span>
                <span class="n">model</span> <span class="o">=</span> <span class="s1">&#39;Bruker_MPFU&#39;</span>
        <span class="k">elif</span> <span class="n">spectrometer</span><span class="p">[</span><span class="s1">&#39;Manufacturer&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;ETH&#39;</span><span class="p">:</span>
            <span class="n">model</span> <span class="o">=</span> <span class="s1">&#39;ETH_AWG&#39;</span>
        <span class="k">elif</span> <span class="n">spectrometer</span><span class="p">[</span><span class="s1">&#39;Manufacturer&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Dummy&#39;</span><span class="p">:</span>
            <span class="n">model</span> <span class="o">=</span> <span class="s1">&#39;Dummy&#39;</span>
        
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">model</span> <span class="o">==</span> <span class="s1">&#39;Dummy&#39;</span><span class="p">:</span>
                <span class="kn">from</span> <span class="nn">autodeer.hardware.dummy</span> <span class="kn">import</span> <span class="n">dummyInterface</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">spectromterInterface</span> <span class="o">=</span> <span class="n">dummyInterface</span><span class="p">(</span><span class="n">filename_edit</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">spectromterInterface</span><span class="o">.</span><span class="n">_savefolder</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_folder</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Bruker</span><span class="o">=</span><span class="kc">False</span>
            <span class="k">elif</span> <span class="n">model</span> <span class="o">==</span> <span class="s1">&#39;ETH_AWG&#39;</span><span class="p">:</span>
                <span class="kn">from</span> <span class="nn">autodeer.hardware.ETH_awg</span> <span class="kn">import</span> <span class="n">ETH_awg_interface</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">spectromterInterface</span> <span class="o">=</span> <span class="n">ETH_awg_interface</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">spectromterInterface</span><span class="o">.</span><span class="n">savefolder</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_folder</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Bruker</span><span class="o">=</span><span class="kc">False</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">modeTuneDialog</span> <span class="o">=</span> <span class="n">ModeTune</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spectromterInterface</span><span class="p">,</span> <span class="n">gyro</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gyro</span><span class="p">,</span> <span class="n">threadpool</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">threadpool</span><span class="p">,</span> <span class="n">current_folder</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">current_folder</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">modeTuneButton</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s1">&#39;Mode Tune&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Resonator_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">modeTuneButton</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">modeTuneButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">modeTuneDialog</span><span class="o">.</span><span class="n">show</span><span class="p">)</span>
                

            <span class="k">elif</span> <span class="n">model</span> <span class="o">==</span> <span class="s1">&#39;Bruker_MPFU&#39;</span><span class="p">:</span>
                <span class="kn">from</span> <span class="nn">autodeer.hardware.Bruker_MPFU</span> <span class="kn">import</span> <span class="n">BrukerMPFU</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">spectromterInterface</span> <span class="o">=</span> <span class="n">BrukerMPFU</span><span class="p">(</span><span class="n">filename_edit</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">spectromterInterface</span><span class="o">.</span><span class="n">savefolder</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_folder</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Bruker</span><span class="o">=</span><span class="kc">True</span>
            <span class="k">elif</span> <span class="n">model</span> <span class="o">==</span> <span class="s1">&#39;Bruker_AWG&#39;</span><span class="p">:</span>
                <span class="kn">from</span> <span class="nn">autodeer.hardware.Bruker_AWG</span> <span class="kn">import</span> <span class="n">BrukerAWG</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">spectromterInterface</span> <span class="o">=</span> <span class="n">BrukerAWG</span><span class="p">(</span><span class="n">filename_edit</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">spectromterInterface</span><span class="o">.</span><span class="n">savefolder</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_folder</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Bruker</span><span class="o">=</span><span class="kc">True</span>
        <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">about</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;ERORR!&#39;</span><span class="p">,</span> 
                              <span class="s1">&#39;The spectrometer interface could not be loaded!</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span>
                              <span class="s1">&#39;Please check that the correct packages are installed!</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span>
                              <span class="s1">&#39;See the documentation for more information.&#39;</span><span class="p">)</span>
            <span class="n">main_log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;The spectrometer interface could not be loaded!&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>


        <span class="n">resonator_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;Resonators&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

        <span class="c1"># Find resonators</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resonatorComboBox</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resonatorComboBox</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;Resonators&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resonatorComboBox</span><span class="o">.</span><span class="n">currentIndexChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">select_resonator</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fcDoubleSpinBox</span><span class="o">.</span><span class="n">valueChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">change_LO</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">resonator_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">about</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;ERORR!&#39;</span><span class="p">,</span> <span class="s1">&#39;No resonators found in config file!&#39;</span><span class="p">)</span>
            <span class="n">main_log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;No resonators found in config file!&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="c1"># Set LO to resonator central frequency</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">select_resonator</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">AWG</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;Spectrometer&#39;</span><span class="p">][</span><span class="s1">&#39;AWG&#39;</span><span class="p">]</span>

        <span class="c1"># Get user preferences</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cores</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;autoDEER&#39;</span><span class="p">][</span><span class="s1">&#39;cores&#39;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">q_DEER</span><span class="o">.</span><span class="n">cores</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cores</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">longDEER</span><span class="o">.</span><span class="n">cores</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cores</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">q_DEER</span><span class="o">.</span><span class="n">cores</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">longDEER</span><span class="o">.</span><span class="n">cores</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="c1"># Extract DeerLab fit parameters</span>
        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;autoDEER&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;DeerLab&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;autoDEER&#39;</span><span class="p">]):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">DL_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;autoDEER&#39;</span><span class="p">][</span><span class="s1">&#39;DeerLab&#39;</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">DL_params</span> <span class="o">=</span> <span class="p">{}</span>
            
            <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;Min_tp&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;autoDEER&#39;</span><span class="p">]):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Min_tp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;autoDEER&#39;</span><span class="p">][</span><span class="s1">&#39;Min_tp&#39;</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">q_DEER</span><span class="o">.</span><span class="n">DL_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DL_params</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">longDEER</span><span class="o">.</span><span class="n">DL_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DL_params</span>
        

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">waveform_precision</span> <span class="o">=</span> <span class="n">spectrometer</span><span class="p">[</span><span class="s1">&#39;Bridge&#39;</span><span class="p">][</span><span class="s1">&#39;Pulse dt&#39;</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">waveform_precision</span> <span class="o">=</span> <span class="mi">1</span> </div>



<div class="viewcode-block" id="autoDEERUI.select_resonator">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.autoDEERUI.select_resonator">[docs]</a>
    <span class="k">def</span> <span class="nf">select_resonator</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">resonatorComboBox</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
        <span class="n">main_log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Selecting resonator </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LO</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;Resonators&#39;</span><span class="p">][</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;Center Freq&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fcDoubleSpinBox</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LO</span><span class="p">)</span>
        <span class="n">main_log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Setting LO to </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">LO</span><span class="si">}</span><span class="s2"> GHz&quot;</span><span class="p">)</span></div>

    
<div class="viewcode-block" id="autoDEERUI.change_LO">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.autoDEERUI.change_LO">[docs]</a>
    <span class="k">def</span> <span class="nf">change_LO</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LO</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fcDoubleSpinBox</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="n">main_log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Setting LO to </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">LO</span><span class="si">}</span><span class="s2"> GHz&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="autoDEERUI.connect_spectrometer">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.autoDEERUI.connect_spectrometer">[docs]</a>
    <span class="k">def</span> <span class="nf">connect_spectrometer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">spectromterInterface</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">about</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;ERORR!&#39;</span><span class="p">,</span> <span class="s1">&#39;A interface needs to be loaded first!&#39;</span><span class="p">)</span>
            <span class="n">main_log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Could not connect to spectrometer. A interface needs to be loaded first!&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>


        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spectromterInterface</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">RuntimeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">about</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;Connection ERORR!&#39;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
            <span class="n">main_log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Could not connect to spectrometer. </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>
            

        <span class="bp">self</span><span class="o">.</span><span class="n">connected</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_spectrometer_connected_light</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span></div>


<div class="viewcode-block" id="autoDEERUI.raise_warning">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.autoDEERUI.raise_warning">[docs]</a>
    <span class="k">def</span> <span class="nf">raise_warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
        <span class="c1"># QDialog.about(self,&#39;Warning!&#39;, message)</span>
        <span class="n">main_log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">message</span><span class="p">)</span></div>


<div class="viewcode-block" id="autoDEERUI.save_data">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.autoDEERUI.save_data">[docs]</a>
    <span class="k">def</span> <span class="nf">save_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">dataset</span><span class="p">,</span><span class="n">experiment</span><span class="p">):</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">create_save_name</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">userinput</span><span class="p">[</span><span class="s1">&#39;sample&#39;</span><span class="p">],</span><span class="n">experiment</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">userinput</span><span class="p">[</span><span class="s1">&#39;project&#39;</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">userinput</span><span class="p">[</span><span class="s1">&#39;comment&#39;</span><span class="p">])</span>
        <span class="n">filename</span> <span class="o">+=</span> <span class="s2">&quot;.h5&quot;</span>
        <span class="n">dataset</span><span class="o">.</span><span class="n">to_netcdf</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_folder</span><span class="p">,</span><span class="n">filename</span><span class="p">),</span><span class="n">engine</span><span class="o">=</span><span class="s1">&#39;h5netcdf&#39;</span><span class="p">,</span><span class="n">invalid_netcdf</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">main_log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Saving dataset to </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="autoDEERUI.fsweep_toolbar">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.autoDEERUI.fsweep_toolbar">[docs]</a>
    <span class="k">def</span> <span class="nf">fsweep_toolbar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">upload_icon</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QIcon</span><span class="p">(</span><span class="s1">&#39;icons:upload.png&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Load_button</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">upload_icon</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Load_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_epr_file</span><span class="p">(</span><span class="s1">&#39;fieldsweep&#39;</span><span class="p">))</span>

        <span class="n">refresh_icon</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QIcon</span><span class="p">(</span><span class="s1">&#39;icons:refresh.png&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Refresh_button</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">refresh_icon</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Refresh_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_fieldsweep</span><span class="p">())</span></div>


<div class="viewcode-block" id="autoDEERUI.respro_toolbar">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.autoDEERUI.respro_toolbar">[docs]</a>
    <span class="k">def</span> <span class="nf">respro_toolbar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">upload_icon</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QIcon</span><span class="p">(</span><span class="s1">&#39;icons:upload.png&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">respro_Load_button</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">upload_icon</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">respro_Load_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_epr_file</span><span class="p">(</span><span class="s1">&#39;respro&#39;</span><span class="p">))</span>

        <span class="n">refresh_icon</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QIcon</span><span class="p">(</span><span class="s1">&#39;icons:refresh.png&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">respro_Refresh_button</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">refresh_icon</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">respro_Refresh_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_respro</span><span class="p">())</span></div>


<div class="viewcode-block" id="autoDEERUI.relax_toolbar">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.autoDEERUI.relax_toolbar">[docs]</a>
    <span class="k">def</span> <span class="nf">relax_toolbar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">upload_icon</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QIcon</span><span class="p">(</span><span class="s1">&#39;icons:upload.png&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relax_Load_button</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">upload_icon</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relax_Load_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_epr_file</span><span class="p">(</span><span class="s1">&#39;relax&#39;</span><span class="p">))</span>

        <span class="n">refresh_icon</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QIcon</span><span class="p">(</span><span class="s1">&#39;icons:refresh.png&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relax_Refresh_button</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">refresh_icon</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relax_Refresh_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_relax</span><span class="p">())</span></div>


<div class="viewcode-block" id="autoDEERUI.update_fieldsweep">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.autoDEERUI.update_fieldsweep">[docs]</a>
    <span class="k">def</span> <span class="nf">update_fieldsweep</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="k">if</span> <span class="n">dataset</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">dataset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_data</span><span class="p">[</span><span class="s1">&#39;fieldsweep&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_data</span><span class="p">[</span><span class="s1">&#39;fieldsweep&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataset</span>

        <span class="n">fsweep_analysis</span> <span class="o">=</span> <span class="n">ad</span><span class="o">.</span><span class="n">FieldSweepAnalysis</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
        <span class="n">fsweep_analysis</span><span class="o">.</span><span class="n">calc_gyro</span><span class="p">()</span>
        <span class="n">main_log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Calculated gyro </span><span class="si">{</span><span class="n">fsweep_analysis</span><span class="o">.</span><span class="n">gyro</span><span class="o">*</span><span class="mf">1e3</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> MHz/T&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">worker</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">worker</span><span class="o">.</span><span class="n">set_noise_mode</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">([</span><span class="n">fsweep_analysis</span><span class="o">.</span><span class="n">calc_noise_level</span><span class="p">(),</span><span class="mi">20</span><span class="p">]))</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">fsweep_ax</span><span class="o">.</span><span class="n">cla</span><span class="p">()</span>
        <span class="n">fsweep_analysis</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">axs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fsweep_ax</span><span class="p">,</span><span class="n">fig</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fsweep_canvas</span><span class="o">.</span><span class="n">figure</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fsweep_canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Tab_widget</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

        <span class="c1"># For Bruker recalculate d0</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">Bruker</span><span class="p">:</span>
            <span class="n">main_log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Calculating d0 from Hahn Echo&quot;</span><span class="p">)</span>
            <span class="n">B</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LO</span><span class="o">/</span><span class="n">fsweep_analysis</span><span class="o">.</span><span class="n">gyro</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spectromterInterface</span><span class="o">.</span><span class="n">calc_d0_from_Hahn_Echo</span><span class="p">(</span><span class="n">B</span><span class="o">=</span><span class="n">B</span><span class="p">,</span> <span class="n">LO</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">LO</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">worker</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">worker</span><span class="o">.</span><span class="n">update_gyro</span><span class="p">(</span><span class="n">fsweep_analysis</span><span class="o">.</span><span class="n">gyro</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">fit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;autoDEER&#39;</span><span class="p">][</span><span class="s1">&#39;FieldSweep&#39;</span><span class="p">][</span><span class="s1">&#39;Fit&#39;</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="n">fit</span> <span class="o">=</span> <span class="kc">False</span>
        
        <span class="n">worker</span> <span class="o">=</span> <span class="n">Worker</span><span class="p">(</span><span class="n">fieldsweep_fit</span><span class="p">,</span> <span class="n">fsweep_analysis</span><span class="p">,</span><span class="n">fit</span><span class="p">)</span>
        <span class="n">worker</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">refresh_fieldsweep_after_fit</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">threadpool</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="n">worker</span><span class="p">)</span></div>


<div class="viewcode-block" id="autoDEERUI.create_fieldsweep_figure">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.autoDEERUI.create_fieldsweep_figure">[docs]</a>
    <span class="k">def</span> <span class="nf">create_fieldsweep_figure</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span>  <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">12.5</span><span class="p">,</span> <span class="mf">6.28</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fsweep_canvas</span> <span class="o">=</span> <span class="n">FigureCanvas</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fsweep_v_left</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fsweep_canvas</span><span class="p">)</span>
        <span class="n">Navbar</span> <span class="o">=</span> <span class="n">NavigationToolbar2QT</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fsweep_canvas</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="n">Navbar</span><span class="o">.</span><span class="n">setMaximumHeight</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fsweep_v_left</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">Navbar</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fsweep_ax</span> <span class="o">=</span> <span class="n">axs</span></div>

 
<div class="viewcode-block" id="autoDEERUI.refresh_fieldsweep_after_fit">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.autoDEERUI.refresh_fieldsweep_after_fit">[docs]</a>
    <span class="k">def</span> <span class="nf">refresh_fieldsweep_after_fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fitresult</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">current_results</span><span class="p">[</span><span class="s1">&#39;fieldsweep&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fitresult</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gyro</span> <span class="o">=</span> <span class="n">fitresult</span><span class="o">.</span><span class="n">gyro</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">waitCondition</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="c1"># Wake up the runner thread</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">waitCondition</span><span class="o">.</span><span class="n">wakeAll</span><span class="p">()</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">fsweep_ax</span><span class="o">.</span><span class="n">cla</span><span class="p">()</span>
        <span class="n">fitresult</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">axs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fsweep_ax</span><span class="p">,</span><span class="n">fig</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fsweep_canvas</span><span class="o">.</span><span class="n">figure</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fsweep_canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

        <span class="c1"># Add fit resultss</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fitresult</span><span class="p">,</span><span class="s1">&#39;results&#39;</span><span class="p">):</span> <span class="c1"># Has been fit</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gyroSpinBox</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">fitresult</span><span class="o">.</span><span class="n">gyro</span><span class="o">*</span><span class="mf">1e3</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gxSpinBox</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="o">-</span><span class="mf">0.0025</span> <span class="o">*</span> <span class="n">fitresult</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">az</span> <span class="o">+</span> <span class="mf">2.0175</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gySpinBox</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">fitresult</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">gy</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gzSpinBox</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">fitresult</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">gz</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">AxSpinBox</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">fitresult</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">axy</span><span class="o">*</span><span class="mf">28.0328</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">AySpinBox</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">fitresult</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">axy</span><span class="o">*</span><span class="mf">28.0328</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">AzSpinBox</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">fitresult</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">az</span><span class="o">*</span><span class="mf">28.0328</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">GBSpinBox</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">fitresult</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">GB</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">BoffsetSpinBox</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">fitresult</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">Boffset</span><span class="p">)</span>

            <span class="n">gxCI</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.0025</span> <span class="o">*</span><span class="n">fitresult</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">azUncert</span><span class="o">.</span><span class="n">ci</span><span class="p">(</span><span class="mi">95</span><span class="p">)</span><span class="o">+</span> <span class="mf">2.0175</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gxCI</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">gxCI</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">gxCI</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gyCI</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">getCIstring</span><span class="p">(</span><span class="n">fitresult</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">gyUncert</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gzCI</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">getCIstring</span><span class="p">(</span><span class="n">fitresult</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">gzUncert</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gyroSpinBox</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">fitresult</span><span class="o">.</span><span class="n">gyro</span><span class="o">*</span><span class="mf">1e3</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gxSpinBox</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gySpinBox</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gzSpinBox</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">AxSpinBox</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">AySpinBox</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">AzSpinBox</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">GBSpinBox</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">BoffsetSpinBox</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">gxCI</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s1">&#39;(-,-)&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gyCI</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s1">&#39;(-,-)&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gzCI</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s1">&#39;(-,-)&#39;</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">Tab_widget</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">pulses</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pulses</span> <span class="o">==</span> <span class="p">{})):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_optimise_pulses_figure</span><span class="p">()</span></div>




<div class="viewcode-block" id="autoDEERUI.update_respro">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.autoDEERUI.update_respro">[docs]</a>
    <span class="k">def</span> <span class="nf">update_respro</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="k">if</span> <span class="n">dataset</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">dataset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_data</span><span class="p">[</span><span class="s1">&#39;respro&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_data</span><span class="p">[</span><span class="s1">&#39;respro&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataset</span>
        
        <span class="n">f_lims</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;Spectrometer&#39;</span><span class="p">][</span><span class="s1">&#39;Bridge&#39;</span><span class="p">][</span><span class="s1">&#39;Min Freq&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;Spectrometer&#39;</span><span class="p">][</span><span class="s1">&#39;Bridge&#39;</span><span class="p">][</span><span class="s1">&#39;Max Freq&#39;</span><span class="p">])</span>

        <span class="c1"># worker = Worker(respro_process, dataset, f_axis,self.current_results[&#39;fieldsweep&#39;], cores=self.cores)</span>
        <span class="n">worker</span> <span class="o">=</span> <span class="n">Worker</span><span class="p">(</span><span class="n">respro_process</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span><span class="n">f_lims</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_results</span><span class="p">[</span><span class="s1">&#39;fieldsweep&#39;</span><span class="p">],</span> <span class="n">cores</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cores</span><span class="p">)</span>

        <span class="n">worker</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">refresh_respro</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">threadpool</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="n">worker</span><span class="p">)</span></div>


<div class="viewcode-block" id="autoDEERUI.create_respro_figure">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.autoDEERUI.create_respro_figure">[docs]</a>
    <span class="k">def</span> <span class="nf">create_respro_figure</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span>  <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">12.5</span><span class="p">,</span> <span class="mf">6.28</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">respro_canvas</span> <span class="o">=</span> <span class="n">FigureCanvas</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
        <span class="n">Navbar</span> <span class="o">=</span> <span class="n">NavigationToolbar2QT</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">respro_canvas</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="n">Navbar</span><span class="o">.</span><span class="n">setMaximumHeight</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">respro_v_left</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">respro_canvas</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">respro_v_left</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">Navbar</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">respro_ax</span> <span class="o">=</span> <span class="n">axs</span></div>



<div class="viewcode-block" id="autoDEERUI.refresh_respro">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.autoDEERUI.refresh_respro">[docs]</a>
    <span class="k">def</span> <span class="nf">refresh_respro</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">LO</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LO</span>
            <span class="n">fitresult</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">LO</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">LO</span> <span class="o">=</span> <span class="n">fitresult</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">fc</span>

            <span class="n">LO_sweep_width</span> <span class="o">=</span> <span class="n">fitresult</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">LO</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">fitresult</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">LO</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
            <span class="n">LO_shift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LO</span> <span class="o">-</span> <span class="n">LO</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">LO_shift</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">LO_sweep_width</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">LO_shift</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">LO</span> <span class="o">+</span> <span class="n">LO_sweep_width</span><span class="o">/</span><span class="mi">2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">LO</span> <span class="o">-</span> <span class="n">LO_sweep_width</span><span class="o">/</span><span class="mi">2</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">worker</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">worker</span><span class="o">.</span><span class="n">update_LO</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LO</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;New LO frequency: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">LO</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> GHz&quot;</span><span class="p">)</span>
            <span class="n">main_log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Setting LO to </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">LO</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2"> GHz&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fitresult</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">current_results</span><span class="p">[</span><span class="s1">&#39;respro&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fitresult</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spectromterInterface</span><span class="o">.</span><span class="n">resonator</span> <span class="o">=</span> <span class="n">fitresult</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">waitCondition</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="c1"># Wake up the runner thread</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">waitCondition</span><span class="o">.</span><span class="n">wakeAll</span><span class="p">()</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">respro_ax</span><span class="o">.</span><span class="n">cla</span><span class="p">()</span>

        <span class="k">if</span> <span class="s1">&#39;fieldsweep&#39;</span><span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_results</span><span class="p">:</span>
            <span class="n">fitresult</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fieldsweep</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">current_results</span><span class="p">[</span><span class="s1">&#39;fieldsweep&#39;</span><span class="p">],</span><span class="n">axs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">respro_ax</span><span class="p">,</span><span class="n">fig</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">respro_canvas</span><span class="o">.</span><span class="n">figure</span><span class="p">);</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fitresult</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">axs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">respro_ax</span><span class="p">,</span><span class="n">fig</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">respro_canvas</span><span class="o">.</span><span class="n">figure</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">respro_canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
        <span class="c1"># Add fit results</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">centreFrequencyDoubleSpinBox</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">fitresult</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">fc</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">centreFrequencyCI</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">fitresult</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">fcUncert</span><span class="o">.</span><span class="n">ci</span><span class="p">(</span><span class="mi">95</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">fitresult</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">fcUncert</span><span class="o">.</span><span class="n">ci</span><span class="p">(</span><span class="mi">95</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">qDoubleSpinBox</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">fitresult</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">q</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">qCI</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">fitresult</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">qUncert</span><span class="o">.</span><span class="n">ci</span><span class="p">(</span><span class="mi">95</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">fitresult</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">qUncert</span><span class="o">.</span><span class="n">ci</span><span class="p">(</span><span class="mi">95</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nu1doubleSpinBox</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">fitresult</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">*</span><span class="mf">1e3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Tab_widget</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">main_log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Resonator centre frequency </span><span class="si">{</span><span class="n">fitresult</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">fc</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> GHz&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">optimise_pulses_button</span><span class="p">()</span></div>



<div class="viewcode-block" id="autoDEERUI.optimise_pulses_button">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.autoDEERUI.optimise_pulses_button">[docs]</a>
    <span class="k">def</span> <span class="nf">optimise_pulses_button</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pulses</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pulses</span> <span class="o">==</span> <span class="p">{}):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">optimise_pulses</span><span class="p">()</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">pulses</span><span class="p">[</span><span class="s1">&#39;pump_pulse&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">optimise_pulses</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_optimise_pulses_figure</span><span class="p">()</span></div>

        

<div class="viewcode-block" id="autoDEERUI.optimise_pulses">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.autoDEERUI.optimise_pulses">[docs]</a>
    <span class="k">def</span> <span class="nf">optimise_pulses</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pulses</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">pulses</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="n">pulses</span> <span class="o">==</span> <span class="p">{}:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pulses</span> <span class="o">=</span> <span class="n">ad</span><span class="o">.</span><span class="n">build_default_pulses</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AWG</span><span class="p">,</span><span class="n">tp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Min_tp</span><span class="p">)</span>
            <span class="c1"># pump_pulse = ad.HSPulse(tp=120, init_freq=-0.25, final_freq=-0.03, flipangle=np.pi, scale=0, order1=6, order2=1, beta=10)</span>
            <span class="c1"># exc_pulse = ad.RectPulse(tp=16, freq=0.02, flipangle=np.pi/2, scale=0)</span>
            <span class="c1"># ref_pulse = exc_pulse.copy(flipangle=np.pi)</span>
        
        <span class="n">pump_pulse</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pulses</span><span class="p">[</span><span class="s1">&#39;pump_pulse&#39;</span><span class="p">]</span>
        <span class="n">ref_pulse</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pulses</span><span class="p">[</span><span class="s1">&#39;ref_pulse&#39;</span><span class="p">]</span>
        <span class="n">exc_pulse</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pulses</span><span class="p">[</span><span class="s1">&#39;exc_pulse&#39;</span><span class="p">]</span>

        <span class="n">pump_pulse</span><span class="p">,</span> <span class="n">exc_pulse</span><span class="p">,</span> <span class="n">ref_pulse</span> <span class="o">=</span> <span class="n">ad</span><span class="o">.</span><span class="n">optimise_pulses</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_results</span><span class="p">[</span><span class="s1">&#39;fieldsweep&#39;</span><span class="p">],</span> <span class="n">pump_pulse</span><span class="p">,</span> <span class="n">exc_pulse</span><span class="p">,</span> <span class="n">ref_pulse</span><span class="p">)</span>
        
        <span class="c1"># self.pulses = {&#39;pump_pulse&#39;:pump_pulse, &#39;exc_pulse&#39;:exc_pulse, &#39;ref_pulse&#39;:ref_pulse}    </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pulses</span><span class="p">[</span><span class="s1">&#39;pump_pulse&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pump_pulse</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pulses</span><span class="p">[</span><span class="s1">&#39;ref_pulse&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ref_pulse</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pulses</span><span class="p">[</span><span class="s1">&#39;exc_pulse&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">exc_pulse</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pulses</span><span class="p">[</span><span class="s1">&#39;det_event&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">freq</span> <span class="o">=</span> <span class="n">exc_pulse</span><span class="o">.</span><span class="n">freq</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pulses</span><span class="p">[</span><span class="s1">&#39;det_event&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tp</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="n">exc_pulse</span><span class="o">.</span><span class="n">tp</span><span class="o">.</span><span class="n">value</span><span class="p">,</span><span class="n">ref_pulse</span><span class="o">.</span><span class="n">tp</span><span class="o">.</span><span class="n">value</span><span class="p">])</span>
        <span class="n">main_log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Optimised pulses&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">worker</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">worker</span><span class="o">.</span><span class="n">new_pulses</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pulses</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">waitCondition</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="c1"># Wake up the runner thread</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">waitCondition</span><span class="o">.</span><span class="n">wakeAll</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update_optimise_pulses_figure</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Tab_widget</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span></div>

    
<div class="viewcode-block" id="autoDEERUI.update_optimise_pulses_figure">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.autoDEERUI.update_optimise_pulses_figure">[docs]</a>
    <span class="k">def</span> <span class="nf">update_optimise_pulses_figure</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">pump_pulse</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pulses</span><span class="p">[</span><span class="s1">&#39;pump_pulse&#39;</span><span class="p">]</span>
        <span class="n">exc_pulse</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pulses</span><span class="p">[</span><span class="s1">&#39;exc_pulse&#39;</span><span class="p">]</span>
        <span class="n">ref_pulse</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pulses</span><span class="p">[</span><span class="s1">&#39;ref_pulse&#39;</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">respro_ax</span><span class="o">.</span><span class="n">cla</span><span class="p">()</span>
        <span class="n">ad</span><span class="o">.</span><span class="n">plot_overlap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_results</span><span class="p">[</span><span class="s1">&#39;fieldsweep&#39;</span><span class="p">],</span> <span class="n">pump_pulse</span><span class="p">,</span> <span class="n">exc_pulse</span><span class="p">,</span><span class="n">ref_pulse</span><span class="p">,</span> <span class="n">axs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">respro_ax</span><span class="p">,</span><span class="n">fig</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">respro_canvas</span><span class="o">.</span><span class="n">figure</span><span class="p">,</span> <span class="n">respro</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">current_results</span><span class="p">[</span><span class="s1">&#39;respro&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">respro_canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

        <span class="c1"># update the pulse parameter grid</span>
        <span class="n">type_to_pulse_hash</span> <span class="o">=</span> <span class="p">{</span><span class="n">ad</span><span class="o">.</span><span class="n">RectPulse</span><span class="p">:</span><span class="s1">&#39;Rect&#39;</span><span class="p">,</span> <span class="n">ad</span><span class="o">.</span><span class="n">ChirpPulse</span><span class="p">:</span><span class="s1">&#39;Chirp&#39;</span><span class="p">,</span> <span class="n">ad</span><span class="o">.</span><span class="n">HSPulse</span><span class="p">:</span><span class="s1">&#39;HS&#39;</span><span class="p">}</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exc_pulse</span><span class="p">,</span> <span class="n">ad</span><span class="o">.</span><span class="n">RectPulse</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ExcFreqBox</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">param_in_MHz</span><span class="p">(</span><span class="n">exc_pulse</span><span class="o">.</span><span class="n">freq</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ExcBWBox</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">exc_pulse</span><span class="o">.</span><span class="n">tp</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ExcBWBox</span><span class="o">.</span><span class="n">setSuffix</span><span class="p">(</span><span class="s1">&#39; ns&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ExcTypeLine</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s1">&#39;Rect&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">center_freq</span> <span class="o">=</span> <span class="p">(</span><span class="n">param_in_MHz</span><span class="p">(</span><span class="n">exc_pulse</span><span class="o">.</span><span class="n">final_freq</span><span class="p">)</span> <span class="o">+</span> <span class="n">param_in_MHz</span><span class="p">(</span><span class="n">exc_pulse</span><span class="o">.</span><span class="n">init_freq</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ExcFreqBox</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">center_freq</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ExcBWBox</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">param_in_MHz</span><span class="p">(</span><span class="n">exc_pulse</span><span class="o">.</span><span class="n">bandwidth</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ExcBWBox</span><span class="o">.</span><span class="n">setSuffix</span><span class="p">(</span><span class="s1">&#39; MHz&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ExcTypeLine</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">type_to_pulse_hash</span><span class="p">[</span><span class="nb">type</span><span class="p">(</span><span class="n">exc_pulse</span><span class="p">)])</span>
        
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ref_pulse</span><span class="p">,</span> <span class="n">ad</span><span class="o">.</span><span class="n">RectPulse</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">RefFreqBox</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">param_in_MHz</span><span class="p">(</span><span class="n">ref_pulse</span><span class="o">.</span><span class="n">freq</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">RefBWBox</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">ref_pulse</span><span class="o">.</span><span class="n">tp</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">RefBWBox</span><span class="o">.</span><span class="n">setSuffix</span><span class="p">(</span><span class="s1">&#39; ns&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">RefTypeLine</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s1">&#39;Rect&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">center_freq</span> <span class="o">=</span> <span class="p">(</span><span class="n">param_in_MHz</span><span class="p">(</span><span class="n">ref_pulse</span><span class="o">.</span><span class="n">final_freq</span><span class="p">)</span> <span class="o">+</span> <span class="n">param_in_MHz</span><span class="p">(</span><span class="n">ref_pulse</span><span class="o">.</span><span class="n">init_freq</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">RefFreqBox</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">center_freq</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">RefBWBox</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">param_in_MHz</span><span class="p">(</span><span class="n">ref_pulse</span><span class="o">.</span><span class="n">bandwidth</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">RefBWBox</span><span class="o">.</span><span class="n">setSuffix</span><span class="p">(</span><span class="s1">&#39; MHz&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">RefTypeLine</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">type_to_pulse_hash</span><span class="p">[</span><span class="nb">type</span><span class="p">(</span><span class="n">ref_pulse</span><span class="p">)])</span>
        
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pump_pulse</span><span class="p">,</span> <span class="n">ad</span><span class="o">.</span><span class="n">RectPulse</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">PumpFreqBox</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">param_in_MHz</span><span class="p">(</span><span class="n">pump_pulse</span><span class="o">.</span><span class="n">freq</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">PumpBWBox</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">pump_pulse</span><span class="o">.</span><span class="n">tp</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">PumpBWBox</span><span class="o">.</span><span class="n">setSuffix</span><span class="p">(</span><span class="s1">&#39; ns&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">PumpTypeLine</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s1">&#39;Rect&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">center_freq</span> <span class="o">=</span> <span class="p">(</span><span class="n">param_in_MHz</span><span class="p">(</span><span class="n">pump_pulse</span><span class="o">.</span><span class="n">final_freq</span><span class="p">)</span> <span class="o">+</span> <span class="n">param_in_MHz</span><span class="p">(</span><span class="n">pump_pulse</span><span class="o">.</span><span class="n">init_freq</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">PumpFreqBox</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">center_freq</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">PumpBWBox</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">param_in_MHz</span><span class="p">(</span><span class="n">pump_pulse</span><span class="o">.</span><span class="n">bandwidth</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">PumpBWBox</span><span class="o">.</span><span class="n">setSuffix</span><span class="p">(</span><span class="s1">&#39; MHz&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">PumpTypeLine</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">type_to_pulse_hash</span><span class="p">[</span><span class="nb">type</span><span class="p">(</span><span class="n">pump_pulse</span><span class="p">)])</span></div>


<div class="viewcode-block" id="autoDEERUI.update_relax">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.autoDEERUI.update_relax">[docs]</a>
    <span class="k">def</span> <span class="nf">update_relax</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">dataset</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">dataset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_data</span><span class="p">[</span><span class="s1">&#39;relax&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_data</span><span class="p">[</span><span class="s1">&#39;relax&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataset</span>

        <span class="n">worker</span> <span class="o">=</span> <span class="n">Worker</span><span class="p">(</span><span class="n">relax_process</span><span class="p">,</span> <span class="n">dataset</span><span class="p">)</span>
        <span class="n">worker</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">refresh_relax</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">threadpool</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="n">worker</span><span class="p">)</span></div>


<div class="viewcode-block" id="autoDEERUI.create_relax_figure">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.autoDEERUI.create_relax_figure">[docs]</a>
    <span class="k">def</span> <span class="nf">create_relax_figure</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span>  <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">12.5</span><span class="p">,</span> <span class="mf">6.28</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relax_canvas</span> <span class="o">=</span> <span class="n">FigureCanvas</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
        <span class="n">Navbar</span> <span class="o">=</span> <span class="n">NavigationToolbar2QT</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">relax_canvas</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="n">Navbar</span><span class="o">.</span><span class="n">setMaximumHeight</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relax_v_left</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">relax_canvas</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relax_v_left</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">Navbar</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relax_ax</span> <span class="o">=</span> <span class="n">axs</span></div>


<div class="viewcode-block" id="autoDEERUI.refresh_relax_figure">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.autoDEERUI.refresh_relax_figure">[docs]</a>
    <span class="k">def</span> <span class="nf">refresh_relax_figure</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">relax_ax</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">relax_ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">cla</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">relax_ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">cla</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">relax_ax</span><span class="o">.</span><span class="n">cla</span><span class="p">()</span>


        <span class="k">if</span> <span class="s1">&#39;relax2D&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_results</span><span class="p">:</span>
            
            <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span>  <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">12.5</span><span class="p">,</span> <span class="mf">6.28</span><span class="p">),</span><span class="n">layout</span><span class="o">=</span><span class="s1">&#39;constrained&#39;</span><span class="p">,</span><span class="n">height_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">relax_canvas</span> <span class="o">=</span> <span class="n">FigureCanvas</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">relax_canvas</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">relax_v_left</span><span class="o">.</span><span class="n">replaceWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">relax_canvas</span><span class="p">,</span><span class="n">relax_canvas</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">relax_canvas</span> <span class="o">=</span> <span class="n">relax_canvas</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">relax_ax</span> <span class="o">=</span> <span class="n">axs</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">current_results</span><span class="p">[</span><span class="s1">&#39;relax2D&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot2D</span><span class="p">(</span><span class="n">axs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">relax_ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_results</span><span class="p">[</span><span class="s1">&#39;relax2D&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot1D</span><span class="p">(</span><span class="n">axs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">relax_ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">)</span>        
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relax_canvas</span><span class="o">.</span><span class="n">figure</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="n">axs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relax_ax</span>
            <span class="n">axs</span><span class="o">.</span><span class="n">cla</span><span class="p">()</span>
            <span class="n">relax1D_results</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="s1">&#39;relax&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_results</span><span class="p">:</span>
                <span class="n">relax1D_results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_results</span><span class="p">[</span><span class="s1">&#39;relax&#39;</span><span class="p">])</span>
            <span class="k">if</span> <span class="s1">&#39;T2_relax&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_results</span><span class="p">:</span>
                <span class="n">relax1D_results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_results</span><span class="p">[</span><span class="s1">&#39;T2_relax&#39;</span><span class="p">])</span>

            <span class="n">ad</span><span class="o">.</span><span class="n">plot_1Drelax</span><span class="p">(</span><span class="o">*</span><span class="n">relax1D_results</span><span class="p">,</span><span class="n">axs</span><span class="o">=</span><span class="n">axs</span><span class="p">,</span><span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">ad</span><span class="o">.</span><span class="n">primary_colors</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">relax_canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span></div>



        
<div class="viewcode-block" id="autoDEERUI.refresh_relax">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.autoDEERUI.refresh_relax">[docs]</a>
    <span class="k">def</span> <span class="nf">refresh_relax</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fitresult</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_results</span><span class="p">[</span><span class="s1">&#39;relax&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fitresult</span>

        <span class="c1"># self.relax_ax.cla()</span>
        <span class="c1"># fitresult.plot(axs=self.relax_ax,fig=self.relax_canvas.figure)</span>
        <span class="c1"># self.relax_canvas.draw()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">refresh_relax_figure</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_eff</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">userinput</span><span class="p">[</span><span class="s1">&#39;label_eff&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="mi">100</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">est_lambda</span> <span class="o">=</span> <span class="mf">0.4</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">aim_time</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">aim_MNR</span> <span class="o">=</span> <span class="mi">20</span>
        
        <span class="n">tau2hrs</span> <span class="o">=</span> <span class="n">fitresult</span><span class="o">.</span><span class="n">find_optimal</span><span class="p">(</span><span class="n">SNR_target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">aim_MNR</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">est_lambda</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">label_eff</span><span class="p">),</span> <span class="n">target_time</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">aim_time</span><span class="p">,</span> <span class="n">target_step</span><span class="o">=</span><span class="mf">0.015</span><span class="p">)</span>
        <span class="n">tau4hrs</span> <span class="o">=</span> <span class="n">fitresult</span><span class="o">.</span><span class="n">find_optimal</span><span class="p">(</span><span class="n">SNR_target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">aim_MNR</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">est_lambda</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">label_eff</span><span class="p">),</span> <span class="n">target_time</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">target_step</span><span class="o">=</span><span class="mf">0.015</span><span class="p">)</span>
        <span class="n">max_tau</span> <span class="o">=</span> <span class="n">fitresult</span><span class="o">.</span><span class="n">find_optimal</span><span class="p">(</span><span class="n">SNR_target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">priorties</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">userinput</span><span class="p">[</span><span class="s1">&#39;priority&#39;</span><span class="p">]]</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">est_lambda</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">label_eff</span><span class="p">),</span> <span class="n">target_time</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">userinput</span><span class="p">[</span><span class="s1">&#39;MaxTime&#39;</span><span class="p">],</span> <span class="n">target_step</span><span class="o">=</span><span class="mf">0.015</span><span class="p">)</span>
    
        <span class="bp">self</span><span class="o">.</span><span class="n">current_results</span><span class="p">[</span><span class="s1">&#39;relax&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tau2hrs</span> <span class="o">=</span> <span class="n">tau2hrs</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">initialise_deer_settings</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">current_results</span><span class="p">[</span><span class="s1">&#39;relax&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max_tau</span> <span class="o">=</span> <span class="n">max_tau</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DipolarEvoMax</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">max_tau</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DipolarEvo2hrs</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">tau2hrs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Tab_widget</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">check_CP</span><span class="p">(</span><span class="n">fitresult</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">worker</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">CP_decay</span> <span class="o">=</span> <span class="n">fitresult</span><span class="o">.</span><span class="n">func</span><span class="p">(</span><span class="n">fitresult</span><span class="o">.</span><span class="n">axis</span><span class="p">,</span> <span class="o">*</span><span class="n">fitresult</span><span class="o">.</span><span class="n">fit_result</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">data</span>
            <span class="c1"># Find the index when CP_decay is below 0.05</span>
            <span class="n">CP_decay</span> <span class="o">=</span> <span class="n">CP_decay</span><span class="o">/</span><span class="n">CP_decay</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">CP_decay_bool</span> <span class="o">=</span> <span class="n">CP_decay</span> <span class="o">&lt;</span> <span class="mf">0.05</span>
            <span class="n">CP_decay_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">CP_decay_bool</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">CP_decay_idx</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">CP_decay_idx</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">CP_decay</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">CP_decay_idx</span> <span class="o">=</span> <span class="n">CP_decay_idx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">max_tau</span> <span class="o">=</span> <span class="n">fitresult</span><span class="o">.</span><span class="n">axis</span><span class="p">[</span><span class="n">CP_decay_idx</span><span class="p">]</span>
            <span class="n">max_tau</span> <span class="o">=</span> <span class="n">ad</span><span class="o">.</span><span class="n">round_step</span><span class="p">(</span><span class="n">max_tau</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">main_log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Max tau </span><span class="si">{</span><span class="n">max_tau</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> us&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">worker</span><span class="o">.</span><span class="n">set_2D_max_tau</span><span class="p">(</span><span class="n">max_tau</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">waitCondition</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="c1"># Wake up the runner thread</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">waitCondition</span><span class="o">.</span><span class="n">wakeAll</span><span class="p">()</span></div>


<div class="viewcode-block" id="autoDEERUI.initialise_deer_settings">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.autoDEERUI.initialise_deer_settings">[docs]</a>
    <span class="k">def</span> <span class="nf">initialise_deer_settings</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        

        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Exp_types</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;4pDEER&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s1">&#39;relax2D&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_results</span><span class="p">):</span>
            <span class="n">exp</span> <span class="o">=</span> <span class="s1">&#39;4pDEER&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">exp</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span>

        
        <span class="k">if</span> <span class="n">exp</span> <span class="o">==</span> <span class="s1">&#39;4pDEER&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">deer_settings</span> <span class="o">=</span> <span class="n">ad</span><span class="o">.</span><span class="n">calc_deer_settings</span><span class="p">(</span><span class="s1">&#39;4pDEER&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">current_results</span><span class="p">[</span><span class="s1">&#39;relax&#39;</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">current_results</span><span class="p">[</span><span class="s1">&#39;relax2D&#39;</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">aim_time</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">aim_MNR</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">est_lambda</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">label_eff</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">waveform_precision</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">deer_settings</span> <span class="o">=</span> <span class="n">ad</span><span class="o">.</span><span class="n">calc_deer_settings</span><span class="p">(</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">current_results</span><span class="p">[</span><span class="s1">&#39;relax&#39;</span><span class="p">],</span><span class="kc">None</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">aim_time</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">aim_MNR</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">est_lambda</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">label_eff</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">waveform_precision</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">deer_settings</span><span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">8</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">deer_settings</span><span class="p">[</span><span class="s1">&#39;ExpType&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;4pDEER&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">deer_settings</span><span class="p">[</span><span class="s1">&#39;tau2&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">deer_settings</span><span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">12</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">deer_settings</span><span class="p">[</span><span class="s1">&#39;tau2&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">20</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">deer_settings</span><span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">16</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">deer_settings</span><span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">8</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">deer_settings</span><span class="p">[</span><span class="s1">&#39;ExpType&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;5pDEER&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">deer_settings</span><span class="p">[</span><span class="s1">&#39;tau2&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">deer_settings</span><span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">12</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">deer_settings</span><span class="p">[</span><span class="s1">&#39;tau2&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span> <span class="o">&gt;</span> <span class="mi">20</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">deer_settings</span><span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">16</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">deer_settings</span><span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">8</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">worker</span><span class="o">.</span><span class="n">update_deersettings</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">deer_settings</span><span class="p">)</span>
        
        <span class="n">main_log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;tau1 set to </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">deer_settings</span><span class="p">[</span><span class="s1">&#39;tau1&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> us&quot;</span><span class="p">)</span>
        <span class="n">main_log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;tau2 set to </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">deer_settings</span><span class="p">[</span><span class="s1">&#39;tau2&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> us&quot;</span><span class="p">)</span>
        <span class="n">main_log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;DEER Sequence set to </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">deer_settings</span><span class="p">[</span><span class="s1">&#39;ExpType&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="autoDEERUI.update_deer_settings">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.autoDEERUI.update_deer_settings">[docs]</a>
    <span class="k">def</span> <span class="nf">update_deer_settings</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_results</span><span class="p">[</span><span class="s1">&#39;quickdeer&#39;</span><span class="p">]</span>
        <span class="n">rec_tau</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_results</span><span class="p">[</span><span class="s1">&#39;quickdeer&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rec_tau_max</span>
        <span class="n">dt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_results</span><span class="p">[</span><span class="s1">&#39;quickdeer&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rec_dt</span> <span class="o">*</span> <span class="mf">1e3</span>
        <span class="n">dt</span> <span class="o">=</span> <span class="n">ad</span><span class="o">.</span><span class="n">round_step</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">waveform_precision</span><span class="p">)</span>
        <span class="n">dt</span><span class="o">=</span> <span class="mi">8</span>
        <span class="n">mod_depth</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">MNR</span> <span class="o">*</span> <span class="n">data</span><span class="o">.</span><span class="n">noiselvl</span>
        <span class="n">remaining_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">MaxTime</span><span class="o">.</span><span class="n">value</span><span class="p">()</span> <span class="o">-</span> <span class="p">((</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">starttime</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">60</span><span class="o">*</span><span class="mi">60</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">correction_factor</span> <span class="o">=</span> <span class="n">ad</span><span class="o">.</span><span class="n">calc_correction_factor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_results</span><span class="p">[</span><span class="s1">&#39;quickdeer&#39;</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">aim_MNR</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">aim_time</span><span class="p">)</span>
        <span class="n">main_log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Correction factor </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">correction_factor</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">SNR_target</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">priorties</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">userinput</span><span class="p">[</span><span class="s1">&#39;priority&#39;</span><span class="p">]]</span>
        <span class="n">SNR_target</span> <span class="o">/=</span> <span class="p">(</span><span class="n">mod_depth</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">correction_factor</span><span class="p">))</span>

        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Exp_types</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;4pDEER&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s1">&#39;relax2D&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_results</span><span class="p">):</span>
            <span class="n">exp</span> <span class="o">=</span> <span class="s1">&#39;4pDEER&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">exp</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span>

        
        <span class="k">if</span> <span class="n">exp</span> <span class="o">==</span> <span class="s1">&#39;4pDEER&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">deer_settings</span> <span class="o">=</span> <span class="n">ad</span><span class="o">.</span><span class="n">calc_deer_settings</span><span class="p">(</span><span class="s1">&#39;4pDEER&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">current_results</span><span class="p">[</span><span class="s1">&#39;relax&#39;</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">current_results</span><span class="p">[</span><span class="s1">&#39;relax2D&#39;</span><span class="p">],</span><span class="n">remaining_time</span><span class="p">,</span><span class="n">SNR_target</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">waveform_precision</span><span class="p">)</span>
            <span class="n">max_tau</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">deer_settings</span><span class="p">[</span><span class="s1">&#39;tau2&#39;</span><span class="p">]</span>
            <span class="n">tau</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">([</span><span class="n">rec_tau</span><span class="p">,</span><span class="n">max_tau</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">deer_settings</span><span class="p">[</span><span class="s1">&#39;tau2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ad</span><span class="o">.</span><span class="n">round_step</span><span class="p">(</span><span class="n">tau</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">waveform_precision</span><span class="o">/</span><span class="mf">1e3</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">deer_settings</span><span class="p">[</span><span class="s1">&#39;tau2&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">deer_settings</span><span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">12</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">deer_settings</span><span class="p">[</span><span class="s1">&#39;tau2&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">20</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">deer_settings</span><span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">16</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">deer_settings</span><span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">8</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">deer_settings</span> <span class="o">=</span> <span class="n">ad</span><span class="o">.</span><span class="n">calc_deer_settings</span><span class="p">(</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">current_results</span><span class="p">[</span><span class="s1">&#39;relax&#39;</span><span class="p">],</span><span class="kc">None</span><span class="p">,</span><span class="n">remaining_time</span><span class="p">,</span><span class="n">SNR_target</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">waveform_precision</span><span class="p">)</span>
            <span class="n">tau</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">deer_settings</span><span class="p">[</span><span class="s1">&#39;tau1&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">deer_settings</span><span class="p">[</span><span class="s1">&#39;tau2&#39;</span><span class="p">]</span>
            <span class="n">tau</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">([</span><span class="n">rec_tau</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">tau</span><span class="o">/</span><span class="mi">2</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">deer_settings</span><span class="p">[</span><span class="s1">&#39;tau2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ad</span><span class="o">.</span><span class="n">round_step</span><span class="p">(</span><span class="n">tau</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">waveform_precision</span><span class="o">/</span><span class="mf">1e3</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">deer_settings</span><span class="p">[</span><span class="s1">&#39;tau1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ad</span><span class="o">.</span><span class="n">round_step</span><span class="p">(</span><span class="n">tau</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">waveform_precision</span><span class="o">/</span><span class="mf">1e3</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">tau</span><span class="o">*</span><span class="mi">2</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">deer_settings</span><span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">12</span>
            <span class="k">elif</span> <span class="n">tau</span><span class="o">*</span><span class="mi">2</span> <span class="o">&gt;</span> <span class="mi">20</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">deer_settings</span><span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">16</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">deer_settings</span><span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">8</span>


        <span class="c1"># self.deer_settings[&#39;dt&#39;] = dt</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">worker</span><span class="o">.</span><span class="n">update_deersettings</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">deer_settings</span><span class="p">)</span>
        
        <span class="n">main_log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;tau1 set to </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">deer_settings</span><span class="p">[</span><span class="s1">&#39;tau1&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> us&quot;</span><span class="p">)</span>
        <span class="n">main_log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;tau2 set to </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">deer_settings</span><span class="p">[</span><span class="s1">&#39;tau2&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> us&quot;</span><span class="p">)</span>
        <span class="n">main_log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;DEER Sequence set to </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">deer_settings</span><span class="p">[</span><span class="s1">&#39;ExpType&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>



<div class="viewcode-block" id="autoDEERUI.update_relax2D">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.autoDEERUI.update_relax2D">[docs]</a>
    <span class="k">def</span> <span class="nf">update_relax2D</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">dataset</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">dataset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_data</span><span class="p">[</span><span class="s1">&#39;relax2D&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_data</span><span class="p">[</span><span class="s1">&#39;relax2D&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataset</span>

        <span class="c1"># Since there is no fitting in the 2D data analysis it can be run in the main threads</span>

        <span class="n">relax2DAnalysis</span> <span class="o">=</span> <span class="n">ad</span><span class="o">.</span><span class="n">RefocusedEcho2DAnalysis</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_results</span><span class="p">[</span><span class="s1">&#39;relax2D&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">relax2DAnalysis</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">refresh_relax_figure</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">initialise_deer_settings</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">waitCondition</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="c1"># Wake up the runner thread</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">waitCondition</span><span class="o">.</span><span class="n">wakeAll</span><span class="p">()</span></div>

        

    
<div class="viewcode-block" id="autoDEERUI.update_T2">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.autoDEERUI.update_T2">[docs]</a>
    <span class="k">def</span> <span class="nf">update_T2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">dataset</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">dataset</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">dataset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_data</span><span class="p">[</span><span class="s1">&#39;T2_relax&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_data</span><span class="p">[</span><span class="s1">&#39;T2_relax&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataset</span>

        
        <span class="n">d_ESEEM</span> <span class="o">=</span> <span class="n">ad</span><span class="o">.</span><span class="n">detect_ESEEM</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span><span class="s1">&#39;deuteron&#39;</span><span class="p">)</span>
        <span class="n">p_ESEEM</span> <span class="o">=</span> <span class="n">ad</span><span class="o">.</span><span class="n">detect_ESEEM</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span><span class="s1">&#39;proton&#39;</span><span class="p">)</span>
        <span class="n">d_ESEEM</span> <span class="o">=</span> <span class="kc">False</span> <span class="c1"># Turn off ESEEM detection</span>
        <span class="n">p_ESEEM</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">d_ESEEM</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">deer_settings</span><span class="p">[</span><span class="s1">&#39;ESEEM&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;deuteron&#39;</span>
            <span class="n">main_log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Detected deuteron ESEEM&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">p_ESEEM</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">deer_settings</span><span class="p">[</span><span class="s1">&#39;ESEEM&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;proton&#39;</span>
            <span class="n">main_log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Detected proton ESEEM&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">deer_settings</span><span class="p">[</span><span class="s1">&#39;ESEEM&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">main_log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No ESEEM detected&quot;</span><span class="p">)</span>
        <span class="c1"># Since the T2 values are not used for anything there is no need pausing the spectrometer    </span>

        <span class="n">T2_worker</span> <span class="o">=</span> <span class="n">Worker</span><span class="p">(</span><span class="n">T2_process</span><span class="p">,</span> <span class="n">dataset</span><span class="p">)</span>
        <span class="n">T2_worker</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">refresh_T2</span><span class="p">)</span>
        <span class="n">T2_worker</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">check_T2</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">threadpool</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="n">T2_worker</span><span class="p">)</span></div>


<div class="viewcode-block" id="autoDEERUI.check_T2">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.autoDEERUI.check_T2">[docs]</a>
    <span class="k">def</span> <span class="nf">check_T2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fitresult</span><span class="p">):</span>
        <span class="c1"># Check if the T2 measurment is too short. </span>

        <span class="n">test_result</span> <span class="o">=</span> <span class="n">fitresult</span><span class="o">.</span><span class="n">check_decay</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">test_result</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">waitCondition</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="c1"># Wake up the runner thread</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">waitCondition</span><span class="o">.</span><span class="n">wakeAll</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">test_dt</span> <span class="o">=</span> <span class="n">fitresult</span><span class="o">.</span><span class="n">axis</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">fitresult</span><span class="o">.</span><span class="n">axis</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">test_dt</span> <span class="o">*=</span> <span class="mf">1e3</span>
            <span class="n">new_dt</span> <span class="o">=</span> <span class="n">ad</span><span class="o">.</span><span class="n">round_step</span><span class="p">(</span><span class="n">test_dt</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">waveform_precision</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">worker</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">worker</span><span class="o">.</span><span class="n">run_T2_relax</span><span class="p">(</span><span class="n">dt</span><span class="o">=</span><span class="n">new_dt</span><span class="p">)</span></div>


<div class="viewcode-block" id="autoDEERUI.check_CP">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.autoDEERUI.check_CP">[docs]</a>
    <span class="k">def</span> <span class="nf">check_CP</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fitresult</span><span class="p">):</span>
        <span class="c1"># Check if the CP measurment is too short. </span>

        <span class="n">test_result</span> <span class="o">=</span> <span class="n">fitresult</span><span class="o">.</span><span class="n">check_decay</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">test_result</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">waitCondition</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="c1"># Wake up the runner thread</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">waitCondition</span><span class="o">.</span><span class="n">wakeAll</span><span class="p">()</span>
                <span class="k">return</span> <span class="kc">None</span>
        <span class="k">elif</span> <span class="n">test_result</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="c1"># The trace needs to be longer</span>
            <span class="n">test_dt</span> <span class="o">=</span> <span class="n">fitresult</span><span class="o">.</span><span class="n">axis</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">fitresult</span><span class="o">.</span><span class="n">axis</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">test_dt</span> <span class="o">*=</span> <span class="mf">1e3</span>
            <span class="n">new_dt</span> <span class="o">=</span> <span class="n">ad</span><span class="o">.</span><span class="n">round_step</span><span class="p">(</span><span class="n">test_dt</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">waveform_precision</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">test_result</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> <span class="c1"># The trace needs to be shorter</span>
            <span class="n">test_dt</span> <span class="o">=</span> <span class="n">fitresult</span><span class="o">.</span><span class="n">axis</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">fitresult</span><span class="o">.</span><span class="n">axis</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">test_dt</span> <span class="o">*=</span> <span class="mf">1e3</span>
            <span class="n">new_dt</span> <span class="o">=</span> <span class="n">ad</span><span class="o">.</span><span class="n">round_step</span><span class="p">(</span><span class="n">test_dt</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">waveform_precision</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">worker</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">worker</span><span class="o">.</span><span class="n">run_CP_relax</span><span class="p">(</span><span class="n">dt</span><span class="o">=</span><span class="n">new_dt</span><span class="p">)</span></div>



<div class="viewcode-block" id="autoDEERUI.refresh_T2">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.autoDEERUI.refresh_T2">[docs]</a>
    <span class="k">def</span> <span class="nf">refresh_T2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fitresult</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_results</span><span class="p">[</span><span class="s1">&#39;T2_relax&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fitresult</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refresh_relax_figure</span><span class="p">()</span></div>


        
<div class="viewcode-block" id="autoDEERUI.advanced_mode_inputs">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.autoDEERUI.advanced_mode_inputs">[docs]</a>
    <span class="k">def</span> <span class="nf">advanced_mode_inputs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Exp_types</span><span class="o">.</span><span class="n">addItems</span><span class="p">([</span><span class="s1">&#39;5pDEER&#39;</span><span class="p">,</span><span class="s1">&#39;4pDEER&#39;</span><span class="p">,</span><span class="s1">&#39;Ref2D&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ExcPulseSelect</span><span class="o">.</span><span class="n">addItems</span><span class="p">([</span><span class="s1">&#39;Auto&#39;</span><span class="p">,</span> <span class="s1">&#39;Rectangular&#39;</span><span class="p">,</span><span class="s1">&#39;Gauss&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">RefPulseSelect</span><span class="o">.</span><span class="n">addItems</span><span class="p">([</span><span class="s1">&#39;Auto&#39;</span><span class="p">,</span> <span class="s1">&#39;Rectangular&#39;</span><span class="p">,</span> <span class="s1">&#39;Gauss&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PumpPulseSelect</span><span class="o">.</span><span class="n">addItems</span><span class="p">([</span><span class="s1">&#39;Auto&#39;</span><span class="p">,</span> <span class="s1">&#39;Rectangular&#39;</span><span class="p">,</span><span class="s1">&#39;Chirp&#39;</span><span class="p">,</span><span class="s1">&#39;HS&#39;</span><span class="p">,</span> <span class="s1">&#39;Gauss&#39;</span><span class="p">])</span></div>


<div class="viewcode-block" id="autoDEERUI.update_quickdeer">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.autoDEERUI.update_quickdeer">[docs]</a>
    <span class="k">def</span> <span class="nf">update_quickdeer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">dataset</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">dataset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_data</span><span class="p">[</span><span class="s1">&#39;quickdeer&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_data</span><span class="p">[</span><span class="s1">&#39;quickdeer&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataset</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Tab_widget</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">q_DEER</span><span class="o">.</span><span class="n">current_data</span><span class="p">[</span><span class="s1">&#39;quickdeer&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataset</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">q_DEER</span><span class="o">.</span><span class="n">update_inputs_from_dataset</span><span class="p">()</span>
        <span class="c1"># self.q_DEER.update_figure()</span>
        <span class="k">def</span> <span class="nf">update_func</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_results</span><span class="p">[</span><span class="s1">&#39;quickdeer&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">update_deer_settings</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">q_DEER</span><span class="o">.</span><span class="n">process_deeranalysis</span><span class="p">(</span><span class="n">wait_condition</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">waitCondition</span><span class="p">,</span><span class="n">update_func</span><span class="o">=</span><span class="n">update_func</span><span class="p">)</span></div>


<div class="viewcode-block" id="autoDEERUI.update_longdeer">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.autoDEERUI.update_longdeer">[docs]</a>
    <span class="k">def</span> <span class="nf">update_longdeer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">dataset</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">dataset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_data</span><span class="p">[</span><span class="s1">&#39;longdeer&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_data</span><span class="p">[</span><span class="s1">&#39;longdeer&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataset</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Tab_widget</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">longDEER</span><span class="o">.</span><span class="n">current_data</span><span class="p">[</span><span class="s1">&#39;quickdeer&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataset</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">longDEER</span><span class="o">.</span><span class="n">update_inputs_from_dataset</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">longDEER</span><span class="o">.</span><span class="n">update_figure</span><span class="p">()</span>
        
        <span class="k">def</span> <span class="nf">update_func</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_results</span><span class="p">[</span><span class="s1">&#39;longdeer&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">longDEER</span><span class="o">.</span><span class="n">process_deeranalysis</span><span class="p">(</span><span class="n">wait_condition</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">waitCondition</span><span class="p">,</span><span class="n">update_func</span><span class="o">=</span><span class="n">update_func</span><span class="p">)</span></div>


<div class="viewcode-block" id="autoDEERUI.update_reptime">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.autoDEERUI.update_reptime">[docs]</a>
    <span class="k">def</span> <span class="nf">update_reptime</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">dataset</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">dataset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_data</span><span class="p">[</span><span class="s1">&#39;reptime&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_data</span><span class="p">[</span><span class="s1">&#39;reptime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataset</span>

        <span class="c1"># reptime_analysis = ad.ReptimeAnalysis(dataset,dataset.sequence)</span>
        <span class="n">reptime_analysis</span> <span class="o">=</span> <span class="n">ad</span><span class="o">.</span><span class="n">ReptimeAnalysis</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
        <span class="n">reptime_analysis</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
        <span class="n">opt_reptime</span> <span class="o">=</span> <span class="n">reptime_analysis</span><span class="o">.</span><span class="n">calc_optimal_reptime</span><span class="p">(</span><span class="mf">0.9</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">opt_reptime</span><span class="o">*</span><span class="mf">1e-3</span> <span class="o">&gt;</span> <span class="mi">8</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">opt_reptime</span><span class="o">*</span><span class="mf">1e-3</span> <span class="o">&lt;</span> <span class="mf">0.5</span><span class="p">):</span>
            <span class="n">main_log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Reptime optimisation failed. Setting to default for spin system&quot;</span><span class="p">)</span>
            <span class="n">opt_reptime</span> <span class="o">=</span> <span class="mf">3e3</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">current_results</span><span class="p">[</span><span class="s1">&#39;reptime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">reptime_analysis</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">worker</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">worker</span><span class="o">.</span><span class="n">update_reptime</span><span class="p">(</span><span class="n">opt_reptime</span><span class="p">)</span>
        <span class="n">main_log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Reptime </span><span class="si">{</span><span class="n">opt_reptime</span><span class="o">*</span><span class="mf">1e-3</span><span class="si">:</span><span class="s2">.2g</span><span class="si">}</span><span class="s2"> ms&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">waitCondition</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="c1"># Wake up the runner thread</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">waitCondition</span><span class="o">.</span><span class="n">wakeAll</span><span class="p">()</span></div>

    
<div class="viewcode-block" id="autoDEERUI.timeout">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.autoDEERUI.timeout">[docs]</a>
    <span class="k">def</span> <span class="nf">timeout</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a pop up box as the experiment has timed out</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;AutoDEER has timedout. The maximum specified time was </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">MaxTime</span><span class="o">.</span><span class="n">value</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">about</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;Warning!&#39;</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span>
        <span class="n">main_log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span></div>


<div class="viewcode-block" id="autoDEERUI.clear_all">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.autoDEERUI.clear_all">[docs]</a>
    <span class="k">def</span> <span class="nf">clear_all</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_results</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_data</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pulses</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">userinput</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">deer_settings</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ESEEM&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;ExpType&#39;</span><span class="p">:</span><span class="s1">&#39;5pDEER&#39;</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">q_DEER</span><span class="o">.</span><span class="n">current_data</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">longDEER</span><span class="o">.</span><span class="n">current_data</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="c1"># Clear the figures</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fsweep_ax</span><span class="o">.</span><span class="n">cla</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fsweep_canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">respro_ax</span><span class="o">.</span><span class="n">cla</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">respro_canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">relax_ax</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span><span class="nb">tuple</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
            <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">relax_ax</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">cla</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">relax_ax</span><span class="o">.</span><span class="n">cla</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relax_canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">q_DEER</span><span class="o">.</span><span class="n">clear_all</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">longDEER</span><span class="o">.</span><span class="n">clear_all</span><span class="p">()</span></div>


<div class="viewcode-block" id="autoDEERUI.RunAutoDEER">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.autoDEERUI.RunAutoDEER">[docs]</a>
    <span class="k">def</span> <span class="nf">RunAutoDEER</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">advanced</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">clear_all</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">spectromterInterface</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">connected</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">about</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;ERORR!&#39;</span><span class="p">,</span> <span class="s1">&#39;A interface needs to be connected first!&#39;</span><span class="p">)</span>
            <span class="n">main_log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Could not run autoDEER. A interface needs to be connected first!&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="n">userinput</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">userinput</span><span class="p">[</span><span class="s1">&#39;MaxTime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">MaxTime</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="n">userinput</span><span class="p">[</span><span class="s1">&#39;project&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ProjectName</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
        <span class="n">userinput</span><span class="p">[</span><span class="s1">&#39;sample&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SampleName</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
        <span class="n">userinput</span><span class="p">[</span><span class="s1">&#39;comment&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">commentLineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
        <span class="n">userinput</span><span class="p">[</span><span class="s1">&#39;priority&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">priotityComboBox</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
        <span class="n">userinput</span><span class="p">[</span><span class="s1">&#39;label_eff&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LabellingEffSpinBox</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="n">userinput</span><span class="p">[</span><span class="s1">&#39;Temp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TempValue</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="n">userinput</span><span class="p">[</span><span class="s1">&#39;DEER_update_func&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">q_DEER</span><span class="o">.</span><span class="n">refresh_deer</span>
        <span class="n">userinput</span><span class="p">[</span><span class="s1">&#39;SampleConc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">SampleConcComboBox_opts</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">SampleConcComboBox</span><span class="o">.</span><span class="n">currentText</span><span class="p">()]</span>
        <span class="n">userinput</span><span class="p">[</span><span class="s1">&#39;tp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Min_tp</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">userinput</span> <span class="o">=</span> <span class="n">userinput</span>

        <span class="k">if</span> <span class="n">advanced</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">deer_settings</span><span class="p">[</span><span class="s1">&#39;ExpType&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Exp_types</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">deer_settings</span><span class="p">[</span><span class="s1">&#39;tau1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tau1Value</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">deer_settings</span><span class="p">[</span><span class="s1">&#39;tau2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tau2Value</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">deer_settings</span><span class="p">[</span><span class="s1">&#39;tau3&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tau3Value</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">deer_settings</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ExpType&#39;</span><span class="p">:</span><span class="s1">&#39;5pDEER&#39;</span><span class="p">,</span><span class="s1">&#39;tau1&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;tau2&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;tau3&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">}</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="s1">&#39;ESEEM&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">deer_settings</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">deer_settings</span><span class="p">[</span><span class="s1">&#39;ESEEM&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Block the autoDEER buttons</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FullyAutoButton</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">AdvancedAutoButton</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resonatorComboBox</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fcDoubleSpinBox</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">night_hours</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;autoDEER&#39;</span><span class="p">][</span><span class="s1">&#39;Night Hours&#39;</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="n">night_hours</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">waitCondition</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QWaitCondition</span><span class="p">()</span>
        <span class="n">mutex</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QMutex</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">worker</span> <span class="o">=</span> <span class="n">autoDEERWorker</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spectromterInterface</span><span class="p">,</span><span class="n">wait</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">waitCondition</span><span class="p">,</span><span class="n">mutex</span><span class="o">=</span><span class="n">mutex</span><span class="p">,</span>
            <span class="n">pulses</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pulses</span><span class="p">,</span><span class="n">results</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">current_results</span><span class="p">,</span> <span class="n">AWG</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">AWG</span><span class="p">,</span> <span class="n">LO</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">LO</span><span class="p">,</span> <span class="n">gyro</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gyro</span><span class="p">,</span>
            <span class="n">user_inputs</span><span class="o">=</span><span class="n">userinput</span><span class="p">,</span> <span class="n">cores</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cores</span><span class="p">,</span><span class="n">night_hours</span><span class="o">=</span><span class="n">night_hours</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">starttime</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">worker</span><span class="o">.</span><span class="n">update_deersettings</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">deer_settings</span><span class="p">)</span>
    
        <span class="bp">self</span><span class="o">.</span><span class="n">worker</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">status</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">msgbar</span><span class="o">.</span><span class="n">setText</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">worker</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">status</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">main_log</span><span class="o">.</span><span class="n">info</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">worker</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">fsweep_result</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">update_fieldsweep</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">worker</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">fsweep_result</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">save_data</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="s1">&#39;EDFS&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">worker</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">respro_result</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">update_respro</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">worker</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">respro_result</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">save_data</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="s1">&#39;ResPro&#39;</span><span class="p">))</span>
        <span class="c1"># self.worker.signals.optimise_pulses.connect(self.optimise_pulses)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">worker</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">relax_result</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">update_relax</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">worker</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">relax_result</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">save_data</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="s1">&#39;CP_Q&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">worker</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">T2_result</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">update_T2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">worker</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">T2_result</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">save_data</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="s1">&#39;T2&#39;</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">worker</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Relax2D_result</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">update_relax2D</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">worker</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Relax2D_result</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">save_data</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="s1">&#39;2D_DEC&#39;</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">worker</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">quickdeer_result</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">update_quickdeer</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">worker</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">quickdeer_result</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">save_data</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="s1">&#39;DEER_5P_Q_quick&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">worker</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">quickdeer_update</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">q_DEER</span><span class="o">.</span><span class="n">refresh_deer</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">worker</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">longdeer_update</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">longDEER</span><span class="o">.</span><span class="n">refresh_deer</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">worker</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">longdeer_result</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">save_data</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="s1">&#39;DEER_5P_Q_long&#39;</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">worker</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">longdeer_result</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">update_longdeer</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">worker</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">reptime_scan_result</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">update_reptime</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">worker</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">timeout</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timeout</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">worker</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">finished</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">FullyAutoButton</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">worker</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">finished</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">AdvancedAutoButton</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">worker</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">finished</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">resonatorComboBox</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">worker</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">finished</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fcDoubleSpinBox</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">stopButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">worker</span><span class="o">.</span><span class="n">stop</span><span class="p">)</span>


        <span class="bp">self</span><span class="o">.</span><span class="n">threadpool</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">worker</span><span class="p">)</span>
        <span class="n">main_log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starting autoDEER&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">worker</span></div>

    
<div class="viewcode-block" id="autoDEERUI.RunFullyAutoDEER">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.autoDEERUI.RunFullyAutoDEER">[docs]</a>
    <span class="k">def</span> <span class="nf">RunFullyAutoDEER</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">RunAutoDEER</span><span class="p">(</span><span class="n">advanced</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>


<div class="viewcode-block" id="autoDEERUI.RunAdvancedAutoDEER">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.autoDEERUI.RunAdvancedAutoDEER">[docs]</a>
    <span class="k">def</span> <span class="nf">RunAdvancedAutoDEER</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">RunAutoDEER</span><span class="p">(</span><span class="n">advanced</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>


<div class="viewcode-block" id="autoDEERUI.create_report">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.autoDEERUI.create_report">[docs]</a>
    <span class="k">def</span> <span class="nf">create_report</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">save_path</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">getSaveFileName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;Save File&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_folder</span><span class="p">,</span> <span class="s2">&quot;.pdf&quot;</span><span class="p">)</span>
        <span class="n">save_path</span> <span class="o">=</span> <span class="n">save_path</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">save_path</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">report</span> <span class="o">=</span> <span class="n">ad</span><span class="o">.</span><span class="n">Reporter</span><span class="p">(</span><span class="n">filepath</span><span class="o">=</span><span class="n">save_path</span><span class="p">,</span><span class="n">pagesize</span><span class="o">=</span><span class="s1">&#39;A4&#39;</span><span class="p">)</span>

        <span class="n">report</span><span class="o">.</span><span class="n">add_title</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">,</span><span class="s1">&#39;autoDEER Report&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">connected</span><span class="p">:</span>
            <span class="n">report</span><span class="o">.</span><span class="n">add_new_section</span><span class="p">(</span><span class="s1">&#39;spec&#39;</span><span class="p">,</span><span class="s1">&#39; Spectrometer&#39;</span><span class="p">)</span>
            <span class="n">report</span><span class="o">.</span><span class="n">add_text</span><span class="p">(</span><span class="s1">&#39;spec&#39;</span><span class="p">,</span> <span class="s1">&#39;Local Name: &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;Spectrometer&#39;</span><span class="p">][</span><span class="s1">&#39;Local Name&#39;</span><span class="p">])</span>
            <span class="n">report</span><span class="o">.</span><span class="n">add_text</span><span class="p">(</span><span class="s1">&#39;spec&#39;</span><span class="p">,</span> <span class="s1">&#39;Manufacturer: &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;Spectrometer&#39;</span><span class="p">][</span><span class="s1">&#39;Manufacturer&#39;</span><span class="p">])</span>
            <span class="n">report</span><span class="o">.</span><span class="n">add_text</span><span class="p">(</span><span class="s1">&#39;spec&#39;</span><span class="p">,</span> <span class="s1">&#39;Model: &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;Spectrometer&#39;</span><span class="p">][</span><span class="s1">&#39;Model&#39;</span><span class="p">])</span>

            <span class="n">report</span><span class="o">.</span><span class="n">add_text</span><span class="p">(</span><span class="s1">&#39;spec&#39;</span><span class="p">,</span> <span class="s1">&#39;Resonator: &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">resonatorComboBox</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span>
            <span class="n">report</span><span class="o">.</span><span class="n">add_space</span><span class="p">(</span><span class="s1">&#39;spec&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        
        <span class="n">report</span><span class="o">.</span><span class="n">add_new_section</span><span class="p">(</span><span class="s1">&#39;inputs&#39;</span><span class="p">,</span><span class="s1">&#39; User Inputs&#39;</span><span class="p">)</span>
        <span class="n">report</span><span class="o">.</span><span class="n">add_text</span><span class="p">(</span><span class="s1">&#39;inputs&#39;</span><span class="p">,</span> <span class="s1">&#39;Sample Name: &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">SampleName</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
        <span class="n">report</span><span class="o">.</span><span class="n">add_text</span><span class="p">(</span><span class="s1">&#39;inputs&#39;</span><span class="p">,</span> <span class="s1">&#39;Temperature: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TempValue</span><span class="o">.</span><span class="n">value</span><span class="p">())</span> <span class="o">+</span> <span class="s1">&#39; K&#39;</span><span class="p">)</span>
        <span class="n">report</span><span class="o">.</span><span class="n">add_text</span><span class="p">(</span><span class="s1">&#39;inputs&#39;</span><span class="p">,</span> <span class="s1">&#39;Max Time: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">MaxTime</span><span class="o">.</span><span class="n">value</span><span class="p">())</span> <span class="o">+</span> <span class="s1">&#39; hours&#39;</span><span class="p">)</span>

        <span class="n">report</span><span class="o">.</span><span class="n">add_page_break</span><span class="p">(</span><span class="s1">&#39;inputs&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="s1">&#39;fieldsweep&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_results</span><span class="p">:</span>
            <span class="n">report</span><span class="o">.</span><span class="n">add_new_section</span><span class="p">(</span><span class="s1">&#39;fieldsweep&#39;</span><span class="p">,</span><span class="s1">&#39; Field Sweep&#39;</span><span class="p">)</span>
            <span class="n">report</span><span class="o">.</span><span class="n">add_figure</span><span class="p">(</span><span class="s1">&#39;fieldsweep&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fsweep_canvas</span><span class="o">.</span><span class="n">figure</span><span class="p">)</span>
            <span class="n">report</span><span class="o">.</span><span class="n">add_text</span><span class="p">(</span><span class="s1">&#39;fieldsweep&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Gyromagnetic Ratio: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">current_results</span><span class="p">[</span><span class="s1">&#39;fieldsweep&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">gyro</span><span class="si">:</span><span class="s2">.3g</span><span class="si">}</span><span class="s2"> GHz/G&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_results</span><span class="p">[</span><span class="s1">&#39;fieldsweep&#39;</span><span class="p">],</span> <span class="s1">&#39;results&#39;</span><span class="p">):</span>
                <span class="n">report</span><span class="o">.</span><span class="n">add_space</span><span class="p">(</span><span class="s1">&#39;fieldsweep&#39;</span><span class="p">)</span>
                <span class="n">report</span><span class="o">.</span><span class="n">add_code_block</span><span class="p">(</span><span class="s1">&#39;fieldsweep&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_results</span><span class="p">[</span><span class="s1">&#39;fieldsweep&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="fm">__str__</span><span class="p">(),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Fit Results&#39;</span><span class="p">)</span>
            <span class="n">report</span><span class="o">.</span><span class="n">add_page_break</span><span class="p">(</span><span class="s1">&#39;fieldsweep&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="s1">&#39;respro&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_results</span><span class="p">:</span>
            <span class="n">report</span><span class="o">.</span><span class="n">add_new_section</span><span class="p">(</span><span class="s1">&#39;respro&#39;</span><span class="p">,</span><span class="s1">&#39; Resonator Profile&#39;</span><span class="p">)</span>
            <span class="n">fig</span><span class="p">,</span><span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
            <span class="n">fitresult</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_results</span><span class="p">[</span><span class="s1">&#39;respro&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="s1">&#39;fieldsweep&#39;</span><span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_results</span><span class="p">:</span>
                <span class="n">fitresult</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fieldsweep</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">current_results</span><span class="p">[</span><span class="s1">&#39;fieldsweep&#39;</span><span class="p">],</span><span class="n">axs</span><span class="o">=</span><span class="n">axs</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">);</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">fitresult</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">axs</span><span class="o">=</span><span class="n">axs</span><span class="p">,</span><span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">)</span>


            <span class="n">report</span><span class="o">.</span><span class="n">add_figure</span><span class="p">(</span><span class="s1">&#39;respro&#39;</span><span class="p">,</span> <span class="n">fig</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_results</span><span class="p">[</span><span class="s1">&#39;respro&#39;</span><span class="p">],</span> <span class="s1">&#39;results&#39;</span><span class="p">):</span>
                <span class="n">report</span><span class="o">.</span><span class="n">add_space</span><span class="p">(</span><span class="s1">&#39;respro&#39;</span><span class="p">)</span>
                <span class="n">report</span><span class="o">.</span><span class="n">add_code_block</span><span class="p">(</span><span class="s1">&#39;respro&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_results</span><span class="p">[</span><span class="s1">&#39;respro&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="fm">__str__</span><span class="p">(),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Fit Results&#39;</span><span class="p">)</span>
            <span class="n">report</span><span class="o">.</span><span class="n">add_page_break</span><span class="p">(</span><span class="s1">&#39;respro&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pulses</span> <span class="o">!=</span> <span class="p">{}:</span>
            <span class="n">pump_pulse</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pulses</span><span class="p">[</span><span class="s1">&#39;pump_pulse&#39;</span><span class="p">]</span>
            <span class="n">exc_pulse</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pulses</span><span class="p">[</span><span class="s1">&#39;exc_pulse&#39;</span><span class="p">]</span>
            <span class="n">ref_pulse</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pulses</span><span class="p">[</span><span class="s1">&#39;ref_pulse&#39;</span><span class="p">]</span>
            <span class="n">report</span><span class="o">.</span><span class="n">add_new_section</span><span class="p">(</span><span class="s1">&#39;pulses&#39;</span><span class="p">,</span><span class="s1">&#39; Optimised Pulses&#39;</span><span class="p">)</span>
            <span class="n">fig</span><span class="p">,</span><span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
            <span class="n">ad</span><span class="o">.</span><span class="n">plot_overlap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_results</span><span class="p">[</span><span class="s1">&#39;fieldsweep&#39;</span><span class="p">],</span> <span class="n">pump_pulse</span><span class="p">,</span> <span class="n">exc_pulse</span><span class="p">,</span><span class="n">ref_pulse</span><span class="p">,</span> <span class="n">axs</span><span class="o">=</span><span class="n">axs</span><span class="p">,</span><span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">)</span>

            <span class="n">report</span><span class="o">.</span><span class="n">add_figure</span><span class="p">(</span><span class="s1">&#39;pulses&#39;</span><span class="p">,</span> <span class="n">fig</span><span class="p">)</span>
            <span class="n">report</span><span class="o">.</span><span class="n">add_space</span><span class="p">(</span><span class="s1">&#39;pulses&#39;</span><span class="p">)</span>

            <span class="n">report</span><span class="o">.</span><span class="n">add_code_block</span><span class="p">(</span><span class="s1">&#39;pulses&#39;</span><span class="p">,</span> <span class="n">exc_pulse</span><span class="o">.</span><span class="fm">__str__</span><span class="p">(),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Excitation Pulse&#39;</span><span class="p">)</span>
            <span class="n">report</span><span class="o">.</span><span class="n">add_code_block</span><span class="p">(</span><span class="s1">&#39;pulses&#39;</span><span class="p">,</span> <span class="n">ref_pulse</span><span class="o">.</span><span class="fm">__str__</span><span class="p">(),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Refocusing Pulse&#39;</span><span class="p">)</span>
            <span class="n">report</span><span class="o">.</span><span class="n">add_code_block</span><span class="p">(</span><span class="s1">&#39;pulses&#39;</span><span class="p">,</span> <span class="n">pump_pulse</span><span class="o">.</span><span class="fm">__str__</span><span class="p">(),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Pump Pulse&#39;</span><span class="p">)</span>


        <span class="k">if</span> <span class="s1">&#39;relax&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_results</span><span class="p">:</span>
            <span class="n">report</span><span class="o">.</span><span class="n">add_new_section</span><span class="p">(</span><span class="s1">&#39;relax&#39;</span><span class="p">,</span><span class="s1">&#39; Relaxation&#39;</span><span class="p">)</span>
            <span class="n">report</span><span class="o">.</span><span class="n">add_figure</span><span class="p">(</span><span class="s1">&#39;relax&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">relax_canvas</span><span class="o">.</span><span class="n">figure</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_results</span><span class="p">[</span><span class="s1">&#39;relax&#39;</span><span class="p">],</span> <span class="s1">&#39;results&#39;</span><span class="p">):</span>
                <span class="n">report</span><span class="o">.</span><span class="n">add_space</span><span class="p">(</span><span class="s1">&#39;relax&#39;</span><span class="p">)</span>
                <span class="n">report</span><span class="o">.</span><span class="n">add_code_block</span><span class="p">(</span><span class="s1">&#39;relax&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_results</span><span class="p">[</span><span class="s1">&#39;relax&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="fm">__str__</span><span class="p">(),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Fit Results&#39;</span><span class="p">)</span>
            <span class="n">report</span><span class="o">.</span><span class="n">add_page_break</span><span class="p">(</span><span class="s1">&#39;relax&#39;</span><span class="p">)</span> 


        <span class="k">if</span> <span class="s1">&#39;quickdeer&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">q_DEER</span><span class="o">.</span><span class="n">current_data</span><span class="p">:</span>
            <span class="n">report</span><span class="o">.</span><span class="n">add_new_section</span><span class="p">(</span><span class="s1">&#39;quickdeer&#39;</span><span class="p">,</span><span class="s1">&#39; QuickDEER&#39;</span><span class="p">)</span>
            <span class="n">fig</span><span class="p">,</span><span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot_mosaic</span><span class="p">([[</span><span class="s1">&#39;Primary_time&#39;</span><span class="p">],</span> 
                                          <span class="p">[</span><span class="s1">&#39;Primary_dist&#39;</span><span class="p">]],</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
            
            <span class="n">ad</span><span class="o">.</span><span class="n">DEERanalysis_plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">q_DEER</span><span class="o">.</span><span class="n">fitresult</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ROI</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">q_DEER</span><span class="o">.</span><span class="n">fitresult</span><span class="o">.</span><span class="n">ROI</span><span class="p">,</span> <span class="n">axs</span><span class="o">=</span> <span class="n">axs</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">report</span><span class="o">.</span><span class="n">add_figure</span><span class="p">(</span><span class="s1">&#39;quickdeer&#39;</span><span class="p">,</span> <span class="n">fig</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="s1">&#39;quickdeer&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_results</span><span class="p">:</span>
                <span class="n">report</span><span class="o">.</span><span class="n">add_space</span><span class="p">(</span><span class="s1">&#39;quickdeer&#39;</span><span class="p">)</span>
                <span class="n">report</span><span class="o">.</span><span class="n">add_code_block</span><span class="p">(</span><span class="s1">&#39;quickdeer&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_results</span><span class="p">[</span><span class="s1">&#39;quickdeer&#39;</span><span class="p">]</span><span class="o">.</span><span class="fm">__str__</span><span class="p">(),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Fit Results&#39;</span><span class="p">)</span>
            <span class="n">report</span><span class="o">.</span><span class="n">add_page_break</span><span class="p">(</span><span class="s1">&#39;quickdeer&#39;</span><span class="p">)</span>
            
        <span class="n">report</span><span class="o">.</span><span class="n">_build</span><span class="p">()</span>
        <span class="k">pass</span></div>
</div>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
<div class="viewcode-block" id="app">
<a class="viewcode-back" href="../../../autoapi/autodeer/gui/main/index.html#autodeer.gui.app">[docs]</a>
    <span class="n">app</span> <span class="o">=</span> <span class="n">QApplication</span><span class="p">([])</span></div>

    <span class="n">app</span><span class="o">.</span><span class="n">setWindowIcon</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QIcon</span><span class="p">(</span><span class="s1">&#39;icons:Square_logo.png&#39;</span><span class="p">))</span>
    <span class="n">app</span><span class="o">.</span><span class="n">setApplicationName</span><span class="p">(</span><span class="s1">&#39;autoDEER&#39;</span><span class="p">)</span>
    <span class="n">app</span><span class="o">.</span><span class="n">setApplicationDisplayName</span><span class="p">(</span><span class="s1">&#39;autoDEER&#39;</span><span class="p">)</span>
    <span class="n">app</span><span class="o">.</span><span class="n">setApplicationVersion</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">ad</span><span class="o">.</span><span class="n">__version__</span><span class="p">))</span>
    <span class="n">window</span> <span class="o">=</span> <span class="n">autoDEERUI</span><span class="p">()</span>
    <span class="n">window</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">app</span><span class="o">.</span><span class="n">exec</span><span class="p">()</span>
</pre></div>
        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2021-2024, Hugo Karas, Gunnar Jeschke, Stefan Stoll
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer no-toc">
      
      
      
    </aside>
  </div>
</div><script src="../../../_static/documentation_options.js?v=48f8e935"></script>
    <script src="../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../_static/copybutton.js?v=f281be69"></script>
    </body>
</html>